<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>vFabric Hyperic 5.7 : About the Agent Launcher and Agent Startup</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
<b><a href="vFabric Hyperic 5.7.html" title="vFabric Hyperic 5.7 Documentation Home">vFabric Hyperic 5.7 Documentation Home (Internal)</a>
 - <a href="https://www.vmware.com/support/pubs/vfabric-hyperic.html">vFabric Hyperic 5.7 Documentation Home (Online)</a>
 -  <a href="https://www.vmware.com/support/vfabric-hyperic/doc/vfabric-hyperic-rn-5.0.html">Hyperic 5.7 Release Notes</a> </b>
 <p>
 <p>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            vFabric Hyperic 5.7 : About the Agent Launcher and Agent Startup
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Feb 08, 2012 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <style type='text/css'>/*<![CDATA[*/
div.rbtoc1328734190454 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1328734190454 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1328734190454 li {margin-left: 0px;padding-left: 0px;}

/*]] >*/</style><div class='rbtoc1328734190454'>
<ul>
    <li><a href='#AbouttheAgentLauncherandAgentStartup-AgentLauncher'>Agent Launcher</a></li>
    <li><a href='#AbouttheAgentLauncherandAgentStartup-WhatHappensWhenanAgentStartsUp'>What Happens When an Agent Starts Up</a></li>
    <li><a href='#AbouttheAgentLauncherandAgentStartup-AutomaticRestartBehavior'>Automatic Restart Behavior</a></li>
</ul></div> 

<blockquote>
<p><b>About this page...</b> </p>

<p>This page describes the Hyperic Agent launcher and the agent startup process. For information about:</p>
<ul>
	<li>Starting an agent &#8212; See <a href="Start, Stop, and Other Agent Operations.html" title="Start, Stop, and Other Agent Operations">Start, Stop, and Other Agent Operations</a></li>
	<li>SSL certificate verification &#8212; See <a href="About SSL in Hyperic.html" title="About SSL in Hyperic">About SSL in Hyperic</a></li>
</ul>
</blockquote>

<h1><a name="AbouttheAgentLauncherandAgentStartup-AgentLauncher"></a>Agent Launcher </h1>
<p><a name="AbouttheAgentLauncherandAgentStartup-AgentLauncher"></a><br/>
The Hyperic Agent launcher is based on the Java Service Wrapper (JSW), a configurable tool that allows Java applications to be run as an NT service or Unix daemon process. It includes fault correction software to automatically restart crashed or frozen JVMs. </p>

<p>JSW runs as a native executable; it invokes and monitors the Hyperic Agent's JVM, based on configuration information provided to the wrapper at startup. In this way, the wrapper supports restarts of the JVM process without stopping the wrapper process itself. The JSW process acts as a watchdog for the JVM process, periodically pinging it for availability. </p>

<p>For more information about the features of the Java Services Wrapper, and how to configure its behavior, see <a href="http://wrapper.tanukisoftware.org/doc/english/download.jsp">http://wrapper.tanukisoftware.org/doc/english/download.jsp</a>.</p>

<h1><a name="AbouttheAgentLauncherandAgentStartup-WhatHappensWhenanAgentStartsUp"></a>What Happens When an Agent Starts Up </h1>
<p><a name="AbouttheAgentLauncherandAgentStartup-AgentStartup"></a></p>

<p>A Hyperic Agent needs to know how to connect to the Hyperic Server, and the Hyperic Server needs to know how to connect to the Hyperic Agent &#8212; each component needs the IP address and listen port (and other connection properties) to use to establish a connection with the other. As described in <a href="About Agent Configuration.html" title="About Agent Configuration">About Agent Configuration</a> you can define the connection properties interactively at first agent startup, or in the agent's <tt>agent.properties</tt> file. </p>

<p>When you start a Hyperic Agent: </p>

<ol>
	<li>The agent checks to see if there is a <tt>/data</tt> directory that contains the Hyperic Server's connection properties.
	<ul>
		<li>At first startup, the <tt>/data</tt> directory will not exist &#8212; it is created after the first successful connection between agent and server is established.</li>
		<li>If the agent finds the connection properties, it tries to connect to the Hyperic Server - see step 5 below.</li>
	</ul>
	</li>
	<li>If the agent did not find the <tt>/data</tt> directory, it looks for an <tt>agent.properties</tt> file in a hidden directory named <tt>.hq</tt> in the home directory of the user that runs the agent.
	<ul>
		<li>This directory will not exist unless you have previously created it. This location for the properties file is supported to ensure configuration data is not lost in the event that the complete agent installation is overwritten in an upgrade.</li>
		<li>If the agent finds the connection properties, it tries to connect to the Hyperic Server - see step 5 below.</li>
	</ul>
	</li>
	<li>If the agent did not find the agent-server connection properties in an <tt>agent.properties</tt> file in the hidden <tt>/.hq</tt> directory, it looks at the <tt>agent.properties</tt> file in its <tt>/conf</tt> directory.
	<ul>
		<li>If the agent finds the connection properties, it tries to connect to the Hyperic Server - see step 5 below.</li>
	</ul>
	</li>
	<li>If the agent did not find connection properties in the <tt>agent.properties</tt> file in its <tt>/conf</tt> directory, it prompts for the properties to be supplied interactively in the command shell.</li>
	<li>Upon obtaining the agent-server connection properties, the agent attempts to connect to the Hyperic Server.</li>
	<li>Once communications between agent and server have been succesfully established:
	<ul>
		<li>The agent saves the Hyperic Server connection settings in <tt>AgentHome/data</tt>.</li>
		<li>The Hyperic Server saves the Hyperic Agent's connection settings in the Hyperic database.</li>
	</ul>
	</li>
</ol>


<h1><a name="AbouttheAgentLauncherandAgentStartup-AutomaticRestartBehavior"></a>Automatic Restart Behavior </h1>
<p><a name="AbouttheAgentLauncherandAgentStartup-AgentRestart"></a></p>

<p>As described above, JSW process periodically pings the agent JVM process. </p>

<p>If the JVM process exits with a non-zero exit code, indicating the JVM is hung or crashed, the JSW will restarts the JVM process. Messages in the Agent and JSW logs indicate that the JSW has restarted the Agent. If the JSW cannot restart the JVM process, it will try again, up to a total of five times. You can configure different actions for the JSW, including the action it takes upon a particular JVM process exit code, and the number of times that it will attempt to restart the process. </p>



				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Oct 01, 2012 10:06</font></td>
		    </tr>
	    </table>
    </body>
</html>
