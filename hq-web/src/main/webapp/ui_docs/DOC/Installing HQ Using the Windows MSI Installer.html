<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <b><a href="vFabric Hyperic 4.6.html" title="vFabric Hyperic 4.6 Documentation Home">vFabric Hyperic 4.6 Documentation Home (Internal)</a> - <a href="https://www.vmware.com/support/pubs/vfabric-hyperic.html">vFabric Hyperic 4.6 Documentation Home (Online)</a> -  <a href="https://www.vmware.com/support/vfabric-hyperic/doc/vfabric-hyperic-rn-4.6.0.html">Hyperic 4.6 Release Notes</a> </b>
<p>      
<p>
        <title>vFabric Hyperic 4.6 : Installing HQ Using the Windows MSI Installer</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            vFabric Hyperic 4.6 : Installing HQ Using the Windows MSI Installer
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 07, 2011 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <p>This section has instructions for installing components using the HQ Windows MSI installation package. You can install the HQ Server, the HQ Agent, or both. The MSI installer can be run interactively or in silent mode.</p>
<style type='text/css'>/*<![CDATA[*/
div.rbtoc1307466674692 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1307466674692 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1307466674692 li {margin-left: 0px;padding-left: 0px;}

/*]] >*/</style><div class='rbtoc1307466674692'>
<ul>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-KnownIssuesonWindows'>Known Issues on Windows</a></li>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-InstallingHQInteractivelyUsingtheHQMSIInstaller'>Installing HQ Interactively Using the HQ MSI Installer</a></li>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-SolvingServiceStartupProblemsAfterMSIInstall'>Solving Service Startup Problems After MSI Install</a></li>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-SyntaxforRunningMSIInstallerinSilentMode'>Syntax for Running MSI Installer in Silent Mode</a></li>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-ExampleSilentModeMSIInvocations'>Example Silent Mode MSI Invocations</a></li>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-MSISilentModeProperties'>MSI Silent Mode Properties</a></li>
    <li><a href='#InstallingHQUsingtheWindowsMSIInstaller-SilentMSIinstallationtoMultipleHostsUsingPushTechniques'>Silent MSI installation to Multiple Hosts Using Push Techniques</a></li>
</ul></div>

<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-KnownIssuesonWindows"></a>Known Issues on Windows</h1>

<p>These requirements apply when you use the MSI installer on Windows:</p>
<ul>
	<li>Installation requires administrator privileges and permissions to install Windows services.</li>
	<li>Uninstallation must be performed by the same user who performed the installation.</li>
</ul>


<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-InstallingHQInteractivelyUsingtheHQMSIInstaller"></a>Installing HQ Interactively Using the HQ MSI Installer</h1>

<p>Follow these steps to run the MSI installer interactively:</p>
<ol>
	<li>Double-click the MSI package.
	<ul>
		<li>A Welcome panel is displayed.</li>
	</ul>
	</li>
	<li>Click <b>Next</b>.
	<ul>
		<li>The SpringSource license agreement is displayed.</li>
	</ul>
	</li>
	<li>Accept the license agreement and click <b>Next</b>.
	<ul>
		<li>The <b>Destination Folder</b>&nbsp;window is displayed, and supplies a default installation folder in the root of the Program Files folder.</li>
	</ul>
	</li>
	<li>If desired, select a different installation folder, and click <b>Next</b>.
	<ul>
		<li>The <b>Setup Type</b> window is displayed.</li>
	</ul>
	</li>
	<li>Choose <b>Complete</b> to install both the HQ Server and the HQ Agent, or <b>Custom</b> to  install one or the other.
	<ul>
		<li>The <b>Ready to Install...</b> window displays the selected installation location, components to install, and a check box for choosing whether or not to install the agent and server as Windows services - uncheck the box if you don not want the services to be started after the installation is complete.</li>
	</ul>
	</li>
	<li>Click <b>Install</b>.&nbsp;</li>
</ol>


<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-SolvingServiceStartupProblemsAfterMSIInstall"></a>Solving Service Startup Problems After MSI Install</h1>

<p>If you install the HQ Server and the HQ Agent on the same machine, and accept the default "Start Hyperic HQ Services when install completes" option, agent startup problems can result.</p>

<p>In this scenario, as a last step, the installer will issue a server start command, followed by an agent start command.</p>

<p>The agent must contact the server to start up successfully. If the machine the HQ components run on is slow or busy, the HQ Server can take a long time to start. The HQ Agent makes a finite number of attempts to connect to the server, and if it continues to fail, the agent gets stuck. No software will be auto-discovered on the platform and the agent will not appear in the HQ user interface.</p>

<p>To solve this problem, force the agent to repeat the setup process by entering this command in a shell:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">AGENT_HOME/bin/hq-agent.bat setup</pre>
		</div>
</div></div>

<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-SyntaxforRunningMSIInstallerinSilentMode"></a>Syntax for Running MSI Installer in Silent Mode</h1>

<p>You can run the HQ MSI installer in silent mode from the DOS prompt.&nbsp; For example:</p>
<ul>
	<li>To install Hyperic HQ, type the following command in a terminal window, supplying the desired installation location, correct installer file name, and the desired installation properties - defined below in <a href="#InstallingHQUsingtheWindowsMSIInstaller-MSISilentModeProperties">MSI Silent Mode Properties</a>.&nbsp; The /qn switch turns off the user interface.
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /i "installer_path\hyperic-hq-installer-4.5.n.build.msi" /qn PROPERTY1=VALUE1 PROPERTY2=VALUE2 ...</pre>
		</div>
</div></div></li>
	<li>To uninstall HQ Enterprise in silent mode, type the following command in a terminal window. You must uninstall from the same user account that used to perform the installation.
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /x "installer_path\hyperic-hqee-installer-4.5.n.build.msi" /qn</pre>
		</div>
</div></div>
<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Opening Windows Command Shell</b><br />On Windows, if you open your command shell from the <b>Start</b> menu, you must run as "Administrator", like this:
<ol>
	<li>Start button - All Programs - Accessories.</li>
	<li>Right click "Command Prompt".</li>
	<li>Select "Run as".</li>
	<li>Choose "Administrator" option.</li>
</ol>
</td></tr></table></div></li>
</ul>


<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-ExampleSilentModeMSIInvocations"></a>Example Silent Mode MSI Invocations</h1>

<ul>
	<li>To silently install HQ Server and the HQ Agent on a local machine under "C:\hyperic":
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /i "installer_path\hyperic-hq-installer-4.5.n.build.msi" /qn INSTALLDIR="C:\hyperic"</pre>
		</div>
</div></div></li>
</ul>


<ul>
	<li>To install (locally) an HQ Agent that will communicate securely with the HQ Server at 69.59.181.106:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /i "installer_path\hyperic-hq-installer-4.5.n.build.msi" /qn ADDLOCAL=Agent AGENT_IS_SECURE=1 AGENT_SERVER_ADDRESS=69.59.181.106 AGENT_SERVER_USER=hqadmin AGENT_SERVER_PASSWORD=password</pre>
		</div>
</div></div></li>
</ul>


<ul>
	<li>To install the HQ Server and the HQ Agent on a local machine using an MSI installer on a remote machine that is accessible on the network:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /i "\\network_path\hyperic-hq-installer-4.5.n.build.msi" PROPERTY1=VALUE1 PROPERTY2=VALUE2 ...</pre>
		</div>
</div></div></li>
</ul>


<ul>
	<li>To silently install the HQ Server and the HQ Agent to a local machine using an MSI installer on a remote machine that is accessible on the network, include the /qn switch to turn off the user interface:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /i "\\network_path\hyperic-hq-installer-4.5.n.build.msi" /qn PROPERTY1=VALUE1PROPERTY2=VALUE2...</pre>
		</div>
</div></div></li>
</ul>


<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-MSISilentModeProperties"></a>MSI Silent Mode Properties</h1>

<p>Installation properties for installing HQ in MSI silent mode are described below.</p>

<p>Note that all properties and their values are case-sensitive.</p>

<p>Properties that begin with the strings SERVER and AGENT are server and agent properties, respectively.</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> <b>Silent Mode Property</b> </th>
<th class='confluenceTh'> <b>Description</b> </th>
<th class='confluenceTh'> <b>Default</b> </th>
</tr>
<tr>
<td class='confluenceTd'> INSTALLDIR </td>
<td class='confluenceTd'> Directory where the HQ components will be installed. </td>
<td class='confluenceTd'> C:\Program Files\Hyperic HQ 4.5 </td>
</tr>
<tr>
<td class='confluenceTd'> ADDLOCAL </td>
<td class='confluenceTd'> Comma-separated list of components to be installed. Allowable case-sensitive values are Agent and Server. <br class="atl-forced-newline" />  <br class="atl-forced-newline" />
Use this property if you want to install only the HQ Server or the HQ Agent. </td>
<td class='confluenceTd'> If you do not specify ADDLOCAL, both agent and server will be installed. <br class="atl-forced-newline" /> </td>
</tr>
<tr>
<td class='confluenceTd'> HQ_ENGINE_JNP_PORT </td>
<td class='confluenceTd'> The JNDI listen port. <br class="atl-forced-newline" />  <br class="atl-forced-newline" />
The value assigned will be saved in the <tt>hq-engine.jnp.port</tt> property in <tt>server.conf</tt>. </td>
<td class='confluenceTd'> 2099 </td>
</tr>
<tr>
<td class='confluenceTd'> HQ_ENGINE_PORT </td>
<td class='confluenceTd'> The JRMP listen port. <br class="atl-forced-newline" />  <br class="atl-forced-newline" />
The value assigned will be saved in the <tt>hq-engine.server.port</tt> property in <tt>server.conf</tt>. </td>
<td class='confluenceTd'> 9093 </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_ADMIN_EMAIL </td>
<td class='confluenceTd'> HQ Server Administrator's email address. <br class="atl-forced-newline" />
Default is based on values of  SERVER_ADMIN_USER and SERVER_MAIL_HOST properties. </td>
<td class='confluenceTd'> SERVER_ADMIN_USER@ <br class="atl-forced-newline" />
SERVER_MAIL_HOST </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_ADMIN_USER </td>
<td class='confluenceTd'> Specifies the user name of the original admin user in HQ.  Will be used in configuring that account. </td>
<td class='confluenceTd'> hqadmin </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_ADMIN&#95; <br class="atl-forced-newline" />
PASSWORD </td>
<td class='confluenceTd'> Specifies the password of the original admin user in HQ server. Will be used in configuring that account. </td>
<td class='confluenceTd'> hqadmin </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_DATABASE&#95; <br class="atl-forced-newline" />
USER </td>
<td class='confluenceTd'> Defines the username the HQ server will use when connecting to the HQ database. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned will be saved in the <tt>server.database-user</tt> property in <tt>server.conf</tt>. </td>
<td class='confluenceTd'> hqadmin </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_DATABASE&#95; <br class="atl-forced-newline" />
PASSWORD </td>
<td class='confluenceTd'> Defines the password the HQ server will use when connecting to the  HQ database. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned will be saved in the <tt>server.database-password</tt> property in the <tt>server.conf</tt> file. </td>
<td class='confluenceTd'> hqadmin </td>
</tr>
<tr>
<td class='confluenceTd'> DB_ENC_KEY_PW<br class="atl-forced-newline" /> </td>
<td class='confluenceTd'> The Database Encryption Key Password. &nbsp;This value will be used to encrypt<br class="atl-forced-newline" />
 the database password so it can not be easily read. &nbsp;Must be at least 8<br class="atl-forced-newline" />
 characters long, there are no restrictions on the type of characters that<br class="atl-forced-newline" />
 may be entered.<br class="atl-forced-newline" /> </td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_MAIL_HOST </td>
<td class='confluenceTd'> The IP address or hostname of the SMTP server that the HQ server will use for sending alerts and other HQ-related emails. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
Most UNIX platforms have a local SMTP server. If you wish to use a non-local SMTP server, specify the address with this property. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned will be saved in the <tt>server.mail.host</tt> property in <tt>server.conf</tt> file. </td>
<td class='confluenceTd'> 127.0.0.1 </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_MAIL_SENDER </td>
<td class='confluenceTd'> The 'From' address in email notifications from the HQ Server. </td>
<td class='confluenceTd'> SERVER_ADMIN_EMAIL </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_POSTGRESQL&#95; <br class="atl-forced-newline" />
PORT </td>
<td class='confluenceTd'> HQ Server's embedded database listen port. </td>
<td class='confluenceTd'> 9432 </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_WEBAPP_HOST </td>
<td class='confluenceTd'> Specifies the HQ Server's listen address for HQ Portal communications. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
By default, this property and AGENT_SERVER_ADDRESS have the same value.  If you wish, you can use these properties to designate different hosts for agent-server and agent-portal communications. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned will be saved in <tt>server.webapp.host</tt> in <tt>server.conf</tt>. </td>
<td class='confluenceTd'> host IP address </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_WEBAPP&#95; <br class="atl-forced-newline" />
PORT </td>
<td class='confluenceTd'> Specifies the HQ Server listen port on which the server listens for HQ Portal communications in non-secure mode. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
By default, this property and AGENT_SERVER_PORT have the same value.  If you wish, you can use these properties to designate different ports for agent-server and agent-portal communications. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned will be saved in the <tt>server.webapp.port</tt> property in <tt>server.conf</tt>. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The HQ Portal Dashboard will be located at the URL of the form: <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">http://SERVER_WEBAPP_HOST:SERVER_WEBAPP_PORT</pre>
		</div>
</div></div> </td>
<td class='confluenceTd'> 7080 </td>
</tr>
<tr>
<td class='confluenceTd'> SERVER_WEBAPP&#95; <br class="atl-forced-newline" />
SECURE_PORT </td>
<td class='confluenceTd'> Specifies the HQ Server port on which the server listens for HQ Portal communications in secure mode. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned will be saved in the <tt>server.webapp.secure.port</tt> property in <tt>server.conf</tt>. </td>
<td class='confluenceTd'> 7443 </td>
</tr>
<tr>
<td class='confluenceTd'> HQ_START_SERVICES </td>
<td class='confluenceTd'> Property indicating whether the HQ Agent and Server processes should be started as a Windows Service at the end of the installation. 1 indicates true, 0 indicates false. </td>
<td class='confluenceTd'> 1 </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_ADDRESS </td>
<td class='confluenceTd'> The IP address to which the agent binds at startup. The default value allows the agent to listen on all IP addresses on the the agent host. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value assigned is saved in both the agent.listenIp and the agent.setup.agentIP properties in agent.properties. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
If there is a firewall between the agent and the server, set AGENT_ADDRESS to the firewall address.  After installation is complete, set agent.listenIP  in agent.properties to the agent's local IP address, and configure the <br class="atl-forced-newline" />
wall to forward agent-bound traffic to that address. </td>
<td class='confluenceTd'> host IP address </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_IS_SECURE </td>
<td class='confluenceTd'> Indicates whether communications between the HQ Agent and the HQ Server should take place over a secure encrypted channel. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
1 indicates secure communications, 0 indicates that communications will not be secured. The setting will be stored appropriately in the agent.setup.camSecure property in agent.properties. </td>
<td class='confluenceTd'> 0 </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_PORT </td>
<td class='confluenceTd'> The port on the agent's listen address to which the agent binds at startup. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
This value is saved to both agent.setup.agentPort and agent.listenPort in agent.properties. </td>
<td class='confluenceTd'> 2144 </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_SERVER_ADDRESS </td>
<td class='confluenceTd'> Specifies the IP address the agent connects to to reach the HQ server. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value is saved to agent.setup.camIP in agent.properties. </td>
<td class='confluenceTd'> host IP address </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_SERVER_USER </td>
<td class='confluenceTd'> The HQ username to use when registering itself with the server. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value is saved to   agent.setup.camLogin in agent.properties. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
Typically this property and AGENT_SERVER_PASSWORD have the same values as SERVER_ADMIN_USER and  SERVER_ADMIN_PASSWORD respectively. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
However, if you are installing a server and an agent on the same host, and the agent will report to a  server on a different host, you might specify  different credentials for  AGENT_SERVER_USER/AGENT_SERVER_PASSWORD  and   SERVER_ADMIN_USER/SERVER_ADMIN_PASSWORD. </td>
<td class='confluenceTd'> hqadmin </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_SERVER_PASSWORD </td>
<td class='confluenceTd'> The password for the user specified by AGENT_SERVER_USER. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value is saved to   agent.setup.camPword in agent.properties. </td>
<td class='confluenceTd'> hqadmin </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_SERVER_PORT </td>
<td class='confluenceTd'> Port on server port to use for non-secure communications with the server. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value is saved to   agent.setup.camPort in agent.properties. </td>
<td class='confluenceTd'> 7080 </td>
</tr>
<tr>
<td class='confluenceTd'> AGENT_SERVER_SSL_PORT </td>
<td class='confluenceTd'> Port on server to use for SSL communications with the server. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
The value is saved to   agent.setup.camSSLPort  in agent.properties. </td>
<td class='confluenceTd'> 7443 </td>
</tr>
</tbody></table>
</div>

<p><br class="atl-forced-newline" /></p>

<h1><a name="InstallingHQUsingtheWindowsMSIInstaller-SilentMSIinstallationtoMultipleHostsUsingPushTechniques"></a>Silent MSI installation to Multiple Hosts Using Push Techniques</h1>

<p>This section describes alternatives for doing silent MSI installs to multiple machines.</p>

<h2><a name="InstallingHQUsingtheWindowsMSIInstaller-UsingATorSOONtostartaprocessonaremoteworkstation"></a>Using AT or SOON to start a process on a remote workstation</h2>

<p>The AT and SOON commands can be used to schedule commands at a future time.   AT, which is built into the command processor, schedules commands and programs to run on a local or remote computer at a specified time. Instead of running processes at a specific time, the SOON command runs them after a specified delay. SOON.EXE is available as a free Microsoft download.</p>

<p>Here are examples of how to run these commands:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">AT targetPC 10:30 /INTERACTIVE \\myPC\myShare\quietInstall.bat
SOON targetPC 30 /INTERACTIVE \\myPC\myShare\quietInstall.bat</pre>
		</div>
</div></div>
<p>Executing processes on a remote system has security implications.</p>
<ul>
	<li>The local machine must have sufficient privileges to start a batch routine on a remote system.</li>
	<li>You must establish privileges for the remote system to access network resources when running the install batch routine. When the command processor runs your batch routine on the target system, it executes with Local System privileges. It is therefore necessary for the batch routine to open a privilege pipe to the network resource containing the MSI package. A workaround is to add a NET command to your batch routine, as demonstrated in this sample quietInstall.bat:</li>
</ul>


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">net use * \\myPC\myShare /user:domain\username password /persistent:no
%Comspec% /c msiexec /i "\\myPC\myShare\hyperic-hq-installer-4.5.n.build.msi" /qn</pre>
		</div>
</div></div>

<h2><a name="InstallingHQUsingtheWindowsMSIInstaller-UsingPsExectoStartaProcessonaRemoteSystem"></a>Using PsExec to Start a Process on a Remote System</h2>

<p>The Windows PsExec utility is a freely distributed light-weight telnet replacement that lets you execute processes on other systems, complete with full interactivity for console applications, without having to manually install client software. PsExec's most powerful uses include launching interactive command prompts on remote systems and remote-enabling tools to show information about remote systems. It can be downloaded as part of the Sysinternal PsToolspackage.</p>

<p>PsExec can be used to run the batch routine at a remote workstation by invoking the following command:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">psexec targetPC -u domain\username -p password -i -c -f
\\myPC\myShare\quietInstall.bat</pre>
		</div>
</div></div>
<p>In the example above, domain\username has local administrative privileges for the targetPC machine. In addition, it should have the necessary privileges to access the myShare folder on the myPC machine.</p>

<p>The batch file quietInstall.bat is used to invoke the MSI installer over the network on the myPC machine. A sample quietInstall.bat might contain the following command:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">%Comspec% /c msiexec /i "\\myPC\myShare\Hyperic HQ 3.2.msi" /qn</pre>
		</div>
</div></div>

<h2><a name="InstallingHQUsingtheWindowsMSIInstaller-RemoteInstallswithMicrosoftManagementConsole"></a>Remote Installs with Microsoft Management Console</h2>

<p>This section has information on how to automatically install components to a group of machines, using Microsoft Management Control and Active Directory.</p>

<p>With Windows Group Policy, HQ components can be automatically installed on a group of machines by performing the following steps:</p>
<ol>
	<li>Log on to the domain controller.</li>
	<li>Copy the MSI file into a folder that is shared with access granted to all target machines.</li>
	<li>Open the Microsoft Management Control (MMC) Active Directory Users and Computers snap-in.</li>
	<li>Navigate to the group of computers onto which an HQ component is to be deployed.</li>
	<li>Open Properties.</li>
	<li>Open Group Policies.</li>
	<li>Add a new polices, and edit it.</li>
	<li>In Computer Configuration/Software Installation, chose New/Package.</li>
	<li>Select the MSI file through the network path.</li>
	<li>Optionally, select that you want HQ to be uninstalled if the computer leaves the scope of the policy.</li>
</ol>


<p>Propagation of group policy propagation typically takes some time. In order to reliably deploy the HQ MSI package, all machines should be rebooted.</p>

<p><font color=""></font></p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jul 28, 2011 14:50</font></td>
		    </tr>
	    </table>
    </body>
</html>
