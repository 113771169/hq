<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>vFabric Hyperic 4.6.5 : Example Plugin Descriptor</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            vFabric Hyperic 4.6.5 : Example Plugin Descriptor
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jan 04, 2012 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">1 &lt;?xml version="1.0"?&gt;
  2 
  3 &lt;!DOCTYPE plugin [
  4   &lt;!ENTITY process-metrics SYSTEM "/pdk/plugins/process-metrics.xml"&gt;
  5 ]&gt;
  6 
  7 &lt;plugin package="org.hyperic.hq.plugin.tomcat" name="tomcat"&gt;
  8   &lt;classpath&gt;
  9     &lt;include name="pdk/lib/mx4j"/&gt;
 10     &lt;!-- relative to auto-discovered installpath (see PROC_HOME_PROPERTY) --&gt;
 11     &lt;include name="server/lib/commons-modeler-*.jar"/&gt;
 12   &lt;/classpath&gt;
 13 
 14   &lt;filter name="template"
 15           value="${OBJECT_NAME}:${alias}"/&gt;
 16 
 17   &lt;metrics name="Thread Metrics"&gt;
 18     &lt;metric name="Thread Count"
 19             alias="ThreadCount"
 20             indicator="false"
 21             template="${OBJECT_NAME}:${alias}"
 22             units="none"
 23             collectionType="trendsup"/&gt;
 24     &lt;metric name="Current Thread Cpu Time"
 25             alias="CurrentThreadCpuTime"
 26             indicator="false"
 27             template="${OBJECT_NAME}:${alias}"
 28             units="ms"
 29             collectionType="trendsup"/&gt;
 30     &lt;metric name="Current Thread User Time"
 31             alias="CurrentThreadUserTime"
 32             indicator="false"
 33             template="${OBJECT_NAME}:${alias}"
 34             units="ms"
 35             collectionType="trendsup"/&gt;
 36     &lt;metric name="Daemon Thread Count"
 37             alias="DaemonThreadCount"
 38             indicator="false"
 39             template="${OBJECT_NAME}:${alias}"
 40             units="none"
 41             collectionType="dynamic"/&gt;
 42     &lt;metric name="Peak Thread Count"
 43             alias="PeakThreadCount"
 44             indicator="false"
 45             template="${OBJECT_NAME}:${alias}"
 46             units="none"
 47             collectionType="static"/&gt;
 48   &lt;/metrics&gt;
 49 
 50   &lt;metrics name="OS Metrics"&gt;
 51     &lt;metric name="Free Swap Space Size"
 52             alias="FreeSwapSpaceSize"
 53             indicator="true"
 54             template="${OBJECT_NAME}:${alias}"
 55             units="B"
 56             collectionType="dynamic"/&gt;
 57     &lt;metric name="Free Physical Memory Size"
 58             alias="FreePhysicalMemorySize"
 59             indicator="true"
 60             template="${OBJECT_NAME}:${alias}"
 61             units="B"
 62             collectionType="dynamic"/&gt;
 63     &lt;metric name="Process Cpu Time"
 64             alias="ProcessCpuTime"
 65             indicator="true"
 66             template="${OBJECT_NAME}:${alias}"
 67             units="ms"
 68             collectionType="trendsup"/&gt;
 69     &lt;metric name="Open File Descriptor Count"
 70             alias="OpenFileDescriptorCount"
 71             indicator="false"
 72             template="${OBJECT_NAME}:${alias}"
 73             units="none"
 74             collectionType="dynamic"/&gt;
 75   &lt;/metrics&gt;
 76 
 77   &lt;metrics name="Runtime Metrics"&gt;
 78     &lt;metric name="UpTime"
 79             alias="Uptime"
 80             indicator="true"
 81             template="${OBJECT_NAME}:${alias}"
 82             units="ms"
 83             collectionType="static"/&gt;
 84   &lt;/metrics&gt;
 85 
 86   &lt;server name="Apache Tomcat"
 87           version="5.5"&gt;
 88 
 89     &lt;property name="VERSION_FILE"
 90               value="server/lib/catalina-storeconfig.jar"/&gt;
 91 
 92     &lt;plugin type="autoinventory"
 93             class="org.hyperic.hq.product.jmx.MxServerDetector"/&gt;
 94     &lt;property name="domain"
 95               value="Catalina"/&gt;
 96 
 97     &lt;property name="OBJECT_NAME"
 98               value="java.lang:type=Runtime"/&gt;
 99     &lt;metrics include="Runtime Metrics"/&gt;
100 
101     &lt;property name="OBJECT_NAME"
102               value="java.lang:type=OperatingSystem"/&gt;
103     &lt;metrics include="OS Metrics"/&gt;
104 
105     &lt;property name="OBJECT_NAME"
106               value="java.lang:type=Threading"/&gt;
107     &lt;metrics include="Thread Metrics"/&gt;
108 
109     &lt;!-- remove -DISABLED to enable server discovery for 5.5 --&gt;
110     &lt;property name="PROC_HOME_PROPERTY"
111               value="catalina.base-DISABLED"/&gt;
112 
113     &lt;property name="DEFAULT_CONF"
114               value="conf/server.xml"/&gt;
115 
116     &lt;property name="DEFAULT_LOG_FILE"
117               value="logs/catalina.out"/&gt;
118 
119     &lt;plugin type="log_track"
120             class="org.hyperic.hq.product.Log4JLogTrackPlugin"/&gt;
121 
122     &lt;property name="DEFAULT_PROGRAM"
123               value="bin/catalina.sh"/&gt;
124 
125     &lt;plugin type="control"
126             class="org.hyperic.hq.product.jmx.MxServerControlPlugin"/&gt;
127 
128     &lt;property name="start.args"
129               value="start"/&gt;
130 
131     &lt;property name="stop.args"
132               value="stop"/&gt;
133 
134     &lt;config&gt;
135       &lt;option name="jmx.url"
136               description="JMX URL to MBeanServer"
137               default="service:jmx:rmi:///jndi/rmi://localhost:6969/jmxrmi"/&gt;
138       &lt;option name="jmx.username"
139               description="JMX username"
140               optional="true"
141               default="system"/&gt;
142       &lt;option name="jmx.password"
143               description="JMX password"
144               optional="true"
145               default="manager"
146               type="secret"/&gt;
147       &lt;option name="ptql"
148               description="PTQL for Tomcat Process"
149               default="State.Name.eq=java,Args.*.ct=catalina.home"/&gt;
150     &lt;/config&gt;
151 
152     &lt;plugin type="measurement"
153             class="org.hyperic.hq.product.jmx.MxMeasurementPlugin"/&gt;
154 
155     &lt;metric name="Availability"
156             template="sigar:Type=ProcState,Arg=%ptql%:State"
157             indicator="true"/&gt;
158 
159     &lt;service name="Web Module Stats"&gt;
160       &lt;property name="OBJECT_NAME"
161                 value="${domain}:j2eeType=WebModule,name=*,J2EEApplication=*,J2EEServer=*"/&gt;
162       &lt;plugin type="autoinventory"/&gt;
163       &lt;plugin type="control"
164               class="org.hyperic.hq.product.jmx.MxControlPlugin"/&gt;
165       &lt;actions include="stop,start,reload"/&gt;
166       &lt;!-- listen for JMX notifications --&gt;
167       &lt;plugin type="log_track"
168               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
169 
170       &lt;config&gt;
171         &lt;option name="name"
172                 description="Name Of Web Module"
173                 default=""/&gt;
174         &lt;option name="J2EEApplication"
175                 description="J2EE Application"
176                 default=""/&gt;
177         &lt;option name="J2EEServer"
178                 description="J2EE Server"
179                 default=""/&gt;
180       &lt;/config&gt;
181       &lt;metric name="Availability"
182               indicator="true"/&gt;
183       &lt;metric name="Processing Time"
184               alias="processingTime"
185               indicator="true"
186               template="${OBJECT_NAME}:${alias}"
187               units="sec"/&gt;
188     &lt;/service&gt;
189 
190     &lt;service name="Thread Pools"&gt;
191       &lt;property name="OBJECT_NAME"
192                 value="${domain}:type=ThreadPool,name=*"/&gt;
193 
194       &lt;plugin type="autoinventory"/&gt;
195 
196       &lt;plugin type="control"
197               class="org.hyperic.hq.product.jmx.MxControlPlugin"/&gt;
198       &lt;actions include="start,shutdown"/&gt;
199 
200       &lt;!-- listen for JMX notifications --&gt;
201       &lt;plugin type="log_track"
202               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
203 
204       &lt;config&gt;
205         &lt;option name="name"
206                 description="Listener Name"
207                 default=""/&gt;
208       &lt;/config&gt;
209       &lt;metric name="Availability"
210               indicator="true"/&gt;
211       &lt;metric name="Current Thread Count"
212               alias="currentThreadCount"
213               indicator="true"
214               template="${OBJECT_NAME}:${alias}"
215               units="none"/&gt;
216       &lt;metric name="Current Thread Busy"
217               alias="currentThreadsBusy"
218               indicator="true"
219               template="${OBJECT_NAME}:${alias}"
220               units="none"/&gt;
221     &lt;/service&gt;
222 
223     &lt;service name="Servlet Monitor"&gt;
224       &lt;property name="OBJECT_NAME"
225                 value="${domain}:j2eeType=Servlet,name=*,WebModule=*,J2EEApplication=*,J2EEServer=*"/&gt;
226 
227       &lt;plugin type="autoinventory"/&gt;
228 
229       &lt;!-- listen for JMX notifications --&gt;
230       &lt;plugin type="log_track"
231               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
232 
233       &lt;config&gt;
234         &lt;option name="WebModule"
235                 description="Deployed Module"
236                 default=""/&gt;
237         &lt;option name="J2EEApplication"
238                 description="J2EE Application"
239                 default=""/&gt;
240         &lt;option name="J2EEServer"
241                 description="J2EE Server"
242                 default=""/&gt;
243       &lt;/config&gt;
244 
245       &lt;metric name="Availability"
246               indicator="true"/&gt;
247       &lt;metric name="Class Load Time"
248               alias="classLoadTime"
249               indicator="false"
250               template="${OBJECT_NAME}:${alias}"
251               units="none"/&gt;
252       &lt;metric name="Error Count"
253               alias="errorCount"
254               indicator="true"
255               template="${OBJECT_NAME}:${alias}"
256               collectionType="trendsup"
257               units="none"/&gt;
258       &lt;metric name="Load Time"
259               alias="loadTime"
260               indicator="false"
261               template="${OBJECT_NAME}:${alias}"
262               units="none"/&gt;
263       &lt;metric name="Processing Time"
264               alias="processingTime"
265               indicator="false"
266               template="${OBJECT_NAME}:${alias}"
267               collectionType="trendsup"
268               units="none"/&gt;
269       &lt;metric name="Request Count"
270               alias="requestCount"
271               indicator="true"
272               template="${OBJECT_NAME}:${alias}"
273               collectionType="trendsup"
274               units="none"/&gt;
275     &lt;/service&gt;
276 
277     &lt;service name="JSP Monitor"&gt;
278       &lt;property name="OBJECT_NAME"
279                 value="${domain}:type=JspMonitor,name=jsp,WebModule=*,J2EEApplication=*,J2EEServer=*"/&gt;
280       &lt;plugin type="autoinventory"/&gt;
281 
282       &lt;!-- listen for JMX notifications --&gt;
283       &lt;plugin type="log_track"
284               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
285 
286       &lt;config&gt;
287         &lt;option name="WebModule"
288                 description="Deployed Module"
289                 default=""/&gt;
290         &lt;option name="J2EEApplication"
291                 description="J2EE Application"
292                 default=""/&gt;
293         &lt;option name="J2EEServer"
294                 description="J2EE Server"
295                 default=""/&gt;
296       &lt;/config&gt;
297       &lt;metric name="Availability"
298               indicator="true"/&gt;
299       &lt;metric name="JSP Count"
300               alias="jspCount"
301               indicator="true"
302               template="${OBJECT_NAME}:${alias}"
303               collectionType="trendsup"
304               units="none"/&gt;
305       &lt;metric name="JSP Reload Count"
306               alias="jspReloadCount"
307               indicator="true"
308               template="${OBJECT_NAME}:${alias}"
309               collectionType="trendsup"
310               units="none"/&gt;
311     &lt;/service&gt;
312 
313     &lt;service name="Global Request Processor"&gt;
314       &lt;property name="OBJECT_NAME"
315                 value="${domain}:type=GlobalRequestProcessor,name=*"/&gt;
316 
317       &lt;plugin type="autoinventory"/&gt;
318 
319       &lt;!-- listen for JMX notifications --&gt;
320       &lt;plugin type="log_track"
321               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
322 
323       &lt;config&gt;
324         &lt;option name="name"
325                 description="Listener Name"
326                 default=""/&gt;
327       &lt;/config&gt;
328 
329       &lt;metric name="Availability"
330               indicator="true"/&gt;
331       &lt;metric name="Bytes Sent"
332               alias="bytesSent"
333               indicator="false"
334               template="${OBJECT_NAME}:${alias}"
335               collectionType="trendsup"
336               units="none"/&gt;
337       &lt;metric name="Bytes Received"
338               alias="bytesReceived"
339               indicator="false"
340               template="${OBJECT_NAME}:${alias}"
341               collectionType="trendsup"
342               units="none"/&gt;
343       &lt;metric name="Error Count"
344               alias="errorCount"
345               indicator="true"
346               template="${OBJECT_NAME}:${alias}"
347               collectionType="trendsup"
348               units="none"/&gt;
349       &lt;metric name="Processing Time"
350               alias="processingTime"
351               indicator="true"
352               template="${OBJECT_NAME}:${alias}"
353               collectionType="trendsup"
354               units="none"/&gt;
355       &lt;metric name="Request Count"
356               alias="requestCount"
357               indicator="true"
358               template="${OBJECT_NAME}:${alias}"
359               collectionType="trendsup"
360               units="none"/&gt;
361     &lt;/service&gt;
362 
363     &lt;service name="Cache"&gt;
364       &lt;property name="OBJECT_NAME"
365                 value="${domain}:type=Cache,host=*,path=*"/&gt;
366 
367       &lt;plugin type="autoinventory"/&gt;
368 
369       &lt;!-- listen for JMX notifications --&gt;
370       &lt;plugin type="log_track"
371               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
372 
373       &lt;config&gt;
374         &lt;option name="path"
375                 description="Context Path of Deployed Application"
376                 default=""/&gt;
377         &lt;option name="host"
378                 description="Hostname"
379                 default=""/&gt;
380                 description="Associated Java Class"
381                 default=""/&gt;
382       &lt;/config&gt;
383 
384       &lt;metric name="Availability"
385               indicator="true"/&gt;
386       &lt;metric name="Access Count"
387               alias="accessCount"
388               indicator="true"
389               template="${OBJECT_NAME}:${alias}"
390               collectionType="trendsup"
391               units="none"/&gt;
392       &lt;metric name="Hits Count"
393               alias="hitsCount"
394               indicator="true"
395               template="${OBJECT_NAME}:${alias}"
396               collectionType="trendsup"
397               units="none"/&gt;
398     &lt;/service&gt;
399 
400     &lt;service name="DataSource Pool"&gt;
401       &lt;property name="OBJECT_NAME"
402                 value="${domain}:type=DataSource,path=*,host=*,class=*,name=*"/&gt;
403 
404       &lt;plugin type="autoinventory"/&gt;
405 
406       &lt;!-- listen for JMX notifications --&gt;
407       &lt;plugin type="log_track"
408               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
409 
410       &lt;config&gt;
411         &lt;option name="path"
412                 description="Context Path of Deployed Application"
413                 default=""/&gt;
414         &lt;option name="host"
415                 description="Hostname"
416                 default=""/&gt;
417         &lt;option name="class"
418                 description="Associated Java Class"
419                 default=""/&gt;
420         &lt;option name="name"
421                 description="Name of Attribute"
422                 default=""/&gt;
423       &lt;/config&gt;
424 
425       &lt;metric name="Availability"
426               indicator="true"/&gt;
427       &lt;metric name="Idle DataSource Connections"
428               alias="numIdle"
429               indicator="true"
430               template="${OBJECT_NAME}:${alias}"
431               units="none"/&gt;
432       &lt;metric name="Active DataSource Connections"
433               alias="numActive"
434               indicator="true"
435               template="${OBJECT_NAME}:${alias}"
436               units="none"/&gt;
437     &lt;/service&gt;
438 
439     &lt;service name="Java Process Metrics"&gt;
440       &lt;config&gt;
441         &lt;option name="process.query"
442                 default="%ptql%"
443                 description="PTQL for Tomcat Java Process"/&gt;
444       &lt;/config&gt;
445       &lt;metric name="Availability"
446               template="sigar:Type=ProcState,Arg=%process.query%:State"
447               indicator="true"/&gt;
448       &amp;process-metrics;
449     &lt;/service&gt;
450 
451     &lt;service name="HTTP"&gt;
452       &lt;config include="http"/&gt;
453       &lt;filter name="template"
454               value="${http.template}:${alias}"/&gt;
455 
456       &lt;metric name="Availability"
457               indicator="true"/&gt;
458 
459       &lt;metric name="Inbound Connections"
460               indicator="true"/&gt;
461 
462       &lt;metric name="Outbound Connections"
463               indicator="true"/&gt;
464     &lt;/service&gt;
465   &lt;/server&gt;
466 
467   &lt;server name="Apache Tomcat"
468           version="6.0"
469           include="5.5"&gt;
470     &lt;property name="VERSION_FILE"
471               value="lib/catalina-ha.jar"/&gt;
472     &lt;!-- derive installpath from -Dcatalina.base=... --&gt;
473     &lt;property name="PROC_HOME_PROPERTY"
474               value="catalina.base"/&gt;
475     &lt;plugin type="autoinventory"
476             class="org.hyperic.hq.product.jmx.MxServerDetector"/&gt;
477   &lt;/server&gt;
478 
479   &lt;!-- ==================== Plugin Help =========================== --&gt;
480   &lt;help name="Apache Tomcat"&gt;
481   &lt;![CDATA[
482   &lt;p&gt;
483   &lt;h3&gt;Configure Apache Tomcat for JMX&lt;/h3&gt;
484   &lt;/p&gt;
485   To configure Tomcat for JMX monitoring see http://tomcat.apache.org/tomcat-${product.version}-doc/monitoring.html.
486   &lt;br&gt;
487   For a quick down and dirty method follow these instructions,
488   &lt;br&gt;
489   in &lt;installpath&gt;/bin/catalina.sh add:
490   &lt;br&gt;
491   [ $1 != "stop" ] &amp;amp;&amp;amp;
492     JAVA_OPTS="-Dcom.sun.management.jmxremote \
493   &lt;br&gt;
494     -Dcom.sun.management.jmxremote.port=6969 \
495   &lt;br&gt;
496     -Dcom.sun.management.jmxremote.ssl=false \
497   &lt;br&gt;
498     -Dcom.sun.management.jmxremote.authenticate=false $JAVA_OPTS"
499   &lt;br&gt;
500     export JAVA_OPTS
501   &lt;br&gt;
502   From there restart Tomcat and that is it.
503   &lt;/p&gt;
504   ]]&gt;
505   &lt;/help&gt;
506   &lt;help name="Apache Tomcat 5.5" include="Apache Tomcat"/&gt;
507   &lt;help name="Apache Tomcat 6.0" include="Apache Tomcat"/&gt;</pre>
		</div>
</div></div>



				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jan 24, 2012 14:52</font></td>
		    </tr>
	    </table>
    </body>
</html>
