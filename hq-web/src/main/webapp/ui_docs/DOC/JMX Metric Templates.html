<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Hyperic 4.6 Documentation : JMX Metric Templates</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Hyperic 4.6 Documentation : JMX Metric Templates
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 07, 2011 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <p><font color="gray"><em>Topics marked with</em></font> <font color="red">*</font> <font color="gray"><em>relate to features available only in vFabric Hyperic.</em></font></p>


<style type='text/css'>/*<![CDATA[*/
div.rbtoc1307466582027 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1307466582027 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1307466582027 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1307466582027'>
<ul>
    <li><a href='#JMXMetricTemplates-ComponentsoftheTemplateforaJMXMetric'>Components of the Template for a JMX Metric</a></li>
    <li><a href='#JMXMetricTemplates-templateAttributeforaJMXMetric'>template Attribute for a JMX Metric</a></li>
    <li><a href='#JMXMetricTemplates-ExampleDefinitionofJMXMetricTemplate'>Example Definition of JMX Metric Template</a></li>
</ul></div>

<h1><a name="JMXMetricTemplates-ComponentsoftheTemplateforaJMXMetric"></a>Components of the Template for a JMX Metric</h1>

<p>A metric template is a structured expression with four segments:</p>

<p><tt>Domain:Properties:Metric:Connection</tt></p>

<p>Each &lt;metric&gt; element's <tt>template</tt> attribute specifies the first three segments of a metric template ---{<tt>Domain:Properties:Metric</tt>. (The properties for the <tt>Connection</tt> segment are defined in the plugin descriptor, but do not form a portion of the <tt>template</tt> attribute; the <tt>Connection</tt> segment is appended to the <tt>template</tt> attribute when a metric value is requested.) </p>

<p>The table below describes the content of a metric template for a JMX metric.</p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Template Component </th>
<th class='confluenceTh'> Description </th>
<th class='confluenceTh'> Notes </th>
</tr>
<tr>
<td class='confluenceTd'> Domain </td>
<td class='confluenceTd'> JMX domain </td>
<td class='confluenceTd'> In a metric template for a JMX metric, the Domain segment is the JMX domain that contains that MBean from which the metric is obtained.&nbsp; <br class="atl-forced-newline" /> <br class="atl-forced-newline" />
Given that the JMX domain is the same for a server type and its child service types, you can define a "Domain" <tt>&lt;property&gt;</tt> in the <tt>&lt;server&gt;</tt> element and reference it in the <tt>template</tt> attribute for metrics.  <tt>${Domain</tt>} returns the value of a "Domain" property. </td>
</tr>
<tr>
<td class='confluenceTd'> Properties </td>
<td class='confluenceTd'> Comma-separated list of name-value pairs that provide the MBean properties that uniquely identify an Mbean in the Domain. <br class="atl-forced-newline" />
<br class="atl-forced-newline" /> <tt>property1=value,propertyN=value</tt> </td>
<td class='confluenceTd'> The property=value pairs supplied here, appended to the Domain value, form the JMX ObjectName for the MBean from which the metric is obtained. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
In most HQ plugins, the key properties for a JMX metric are defined as a <tt>&lt;property&gt;</tt> ("OBJECT_NAME" in the example below) which each resource element defines uniquely. <br class="atl-forced-newline" />
<br class="atl-forced-newline" />
Key property values can be defined explicitly in the <tt>template</tt> attribute,  supplied by a plugin class, or as resource-specific configuration <tt>&lt;option&gt;</tt>. <br class="atl-forced-newline" /> </td>
</tr>
<tr>
<td class='confluenceTd'> Metric </td>
<td class='confluenceTd'> The MBean attribute that supplies the metric value. </td>
<td class='confluenceTd'> Typically, the the attribute name is defined in each <tt>&lt;metric&gt;</tt> element's <tt>alias</tt> attribute, and is referenced in the <tt>template</tt>  as <tt>${alias</tt>}. </td>
</tr>
<tr>
<td class='confluenceTd'> Connection </td>
<td class='confluenceTd'>JMX URL and credentials.   </td>
<td class='confluenceTd'> Defined in <tt>&lt;option&gt;</tt> elements to appear in the "Shared" section of a resource's <b>Configuration Properties</b> page. Appended by plugin class to Domain:Properties:Metric when the value of the metric is requested.  </td>
</tr>
</tbody></table>
</div>

<p></p>

<h1><a name="JMXMetricTemplates-templateAttributeforaJMXMetric"></a>template Attribute for a JMX Metric</h1>

<p>Defined explicitly (without variables), the <tt>template</tt> attribute for a JMX metric is formed like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">template=JmxDomain:property1=value,propertyN=value:MbeanAttribute</pre>
		</div>
</div></div>

<p>In practice, the the <tt>template</tt> attribute for a JMX metric is expressed using variables, for example: </p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">template="${OBJECT_NAME}:${alias}"</pre>
		</div>
</div></div>

<h1><a name="JMXMetricTemplates-ExampleDefinitionofJMXMetricTemplate"></a>Example Definition of JMX Metric Template</h1>

<p>In HQ's apache tomcat plugin descriptor, portions of which are excerpted below, metric templates are defined in this fashion:</p>

<ul>
	<li><b>JMX Domain</b> &#45; The JMX domain is defined in line 94 in a <tt>&lt;property&gt;</tt> element named "domain" below the <tt>&lt;server&gt;</tt> element for Tomcat 5.5. This value is inherited by each child <tt>&lt;service&gt;</tt>.</li>
</ul>


<ul>
	<li><b>Key Properties</b> &#45; Each <tt>&lt;service&gt;</tt> defines a <tt>&lt;property&gt;</tt> named "OBJECT_NAME", like the one on line 365 for the service type "Cache". "OBJECT_NAME" defines the JMX ObjectName for the target MBean.  The value of the "domain" property is returned by the <tt>${domain</tt>} variable; the value of the "type" property (the Mbean type) is explicitly defined as "Cache"; the values of "host" and "path", provided by the <tt>MxServerDetector</tt> class, are referenced in this form: <tt>host=&#42;,path=&#42;</tt>.</li>
</ul>


<ul>
	<li><b>MBean attribute</b> &#45; Each <tt>metric</tt> element's <tt>alias</tt> attribute is set to the name of an MBean attribute.</li>
</ul>


<ul>
	<li><b>Complete <tt>template</tt> attribute</b> - Each <tt>metric</tt> element's <tt>template</tt> is defined as <tt>template="${OBJECT_NAME}:${alias}"</tt></li>
</ul>


<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">86 &lt;server name="Apache Tomcat"
87         version="5.5"&gt;
88
89        &lt;property name="VERSION_FILE"
90                  value="server/lib/catalina-storeconfig.jar"/&gt;
91
92        &lt;plugin type="autoinventory"
93                class="org.hyperic.hq.product.jmx.MxServerDetector"/&gt;
94        &lt;property name="domain"
95                   value="Catalina"/&gt;

...
...
...
363       &lt;service name="Cache"&gt;
364                &lt;property name="OBJECT_NAME"
365                          value="${domain}:type=Cache,host=*,path=*"/&gt;
366
367       &lt;plugin type="autoinventory"/&gt;
368
369       &lt;!-- listen for JMX notifications --&gt;
370       &lt;plugin type="log_track"
371               class="org.hyperic.hq.product.jmx.MxNotificationPlugin"/&gt;
372
373       &lt;config&gt;
374            &lt;option name="path"
375                    description="Context Path of Deployed Application"
376                    default=""/&gt;
377            &lt;option name="host"
378                    description="Hostname"
379                    default=""/&gt;
380                    description="Associated Java Class"
381                    default=""/&gt;
382       &lt;/config&gt;
...
...
...
386       &lt;metric name="Access Count"
387               alias="accessCount"
388               indicator="true"
389               template="${OBJECT_NAME}:${alias}"
390               collectionType="trendsup"
391               units="none"/&gt;</pre>
		</div>
</div></div> 

<div class="scroll-pagebreak"></div>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 14, 2011 15:09</font></td>
		    </tr>
	    </table>
    </body>
</html>
