<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Hyperic 4.6 Documentation : Deploying Multiple Hyperic Agents</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Hyperic 4.6 Documentation : Deploying Multiple Hyperic Agents
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 09, 2011 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <style type='text/css'>/*<![CDATA[*/
div.rbtoc1307647457224 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1307647457224 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1307647457224 li {margin-left: 0px;padding-left: 0px;}

/*]] >*/</style><div class='rbtoc1307647457224'>
<ul>
    <li><a href='#DeployingMultipleHypericAgents-EstablishInstallationEnvironment'>Establish Installation Environment</a></li>
<ul>
    <li><a href='#DeployingMultipleHypericAgents-SetupanInstallServer'>Set up an Install Server</a></li>
    <li><a href='#DeployingMultipleHypericAgents-CreateAccountsandInstallationDirectoriesonTargetPlatforms'>Create Accounts and Installation Directories on Target Platforms</a></li>
</ul>
    <li><a href='#DeployingMultipleHypericAgents-CreateStandardAgentPropertiesFile'>Create Standard Agent Properties File</a></li>
    <li><a href='#DeployingMultipleHypericAgents-PerformRemoteAgentInstallations'>Perform Remote Agent Installations</a></li>
<ul>
    <li><a href='#DeployingMultipleHypericAgents-InstallandStartAgentsOnebyOne'>Install and Start Agents One-by-One</a></li>
    <li><a href='#DeployingMultipleHypericAgents-DeployandStartMultipleAgentsatOnce'>Deploy and Start Multiple Agents at Once</a></li>
</ul>
    <li><a href='#DeployingMultipleHypericAgents-VerifySuccessfulAgentStartup'>Verify Successful Agent Startup</a></li>
</ul></div>
<p>This section has recommendations for how to deploy agents in volume in a large Hyperic environment.</p>


<h1><a name="DeployingMultipleHypericAgents-EstablishInstallationEnvironment"></a>Establish Installation Environment</h1>

<h2><a name="DeployingMultipleHypericAgents-SetupanInstallServer"></a>Set up an Install Server</h2>

<p>Choose a machine that can access all target platforms from which to perform remote installation. We refer to this as the "install server". On the install server, create a user account, for instance "hyperic", with  permissions required to SSH into each target platform without a password.</p>

<h2><a name="DeployingMultipleHypericAgents-CreateAccountsandInstallationDirectoriesonTargetPlatforms"></a>Create Accounts and Installation Directories on Target Platforms</h2>

<p>On each platform to which you'll install an agent:</p>
<ul>
	<li>Create an account that is identical to the one you created on the install server.</li>
</ul>


<ul>
	<li>Create identical installation directories, for example, <tt>/home/hyperic</tt>.</li>
</ul>


<ul>
	<li>On Windows systems, create an <tt>.hq</tt> direcotyr in the user home directory that contains the installation directory you just created. You must open a command shell, and use the mkdir command to create the <tt>.hq</tt> directory.&nbsp; (This directory is created automatically when you install the Hyperic Agent on Unix-like systems.</li>
</ul>


<h1><a name="DeployingMultipleHypericAgents-CreateStandardAgentPropertiesFile"></a>Create Standard Agent Properties File</h1>

<p>To enable mass agent deployment, you create an <tt>agent.properties</tt> that defines the agent properties required for the agent to start up and connect with the Hyperic Server.  If you supply the necessary information in the properties file, each Hyperic Agent will find its setup configuration at startup, rather querying for it interactively.</p>

<p>At a minimum, you must define the Hyperic Server address and port. In addition, you can configure optional agent behaviors that are controlled by agent properties.  For more information, see <a href="Configure Agent - Server Communication in Properties File.html" title="Configure Agent - Server Communication in Properties File">Configure Agent &#45; Server Communication in Properties File</a>.</p>

<p>The first time you start the agent, it will obtain the server connection information it needs to contact the server and register itself.</p>

<h1><a name="DeployingMultipleHypericAgents-PerformRemoteAgentInstallations"></a>Perform Remote Agent Installations</h1>

<h2><a name="DeployingMultipleHypericAgents-InstallandStartAgentsOnebyOne"></a>Install and Start Agents One-by-One</h2>

<p>Follow these steps to install agents one-by-one. To install to all target platforms at once, see <a href="#DeployingMultipleHypericAgents-DeployandStartMultipleAgentsatOnce">Deploy and Start Multiple Agents at Once</a> below.</p>
<ol>
	<li>Log on to your installation account on the install server.</li>
	<li>SSH to the remote platform.</li>
	<li>Copy the agent archive to the agent host.</li>
	<li>Unpack the agent archive.</li>
	<li>Copy the <tt>agent.properties file</tt> to the <tt>/.hq</tt> directory under the home directory of the standard agent installation user account.</li>
	<li>If you are upgrading an 3.x agent to 4.x, stop the 3.x agent, if necessary.</li>
	<li>Start the new agent.</li>
</ol>


<h2><a name="DeployingMultipleHypericAgents-DeployandStartMultipleAgentsatOnce"></a>Deploy and Start Multiple Agents at Once</h2>

<p>Deploy an agent to each host listed in <tt>hosts.txt</tt> by</p>
<ol>
	<li>Create a <tt>hosts.txt</tt> file on your install server that maps hostname to IP address for each platform to which you wish to install the agent.</li>
	<li>Open a command shell on the install server.</li>
	<li>Entering the following commandd in the shell, supplying the correct name of the agent package in the export command:
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">$ export AGENT=hyperic-hq-agent-4.0.0-x86-linux.tgz
$ for host in `cat hosts.txt`; do scp $AGENT $host: &amp;&amp; ssh $host "tar zxf $AGENT &amp;&amp; ./hyperic-hq-agent-4.0.0/hq-agent.sh start"; done</pre>
		</div>
</div></div></li>
</ol>


<blockquote>
<p>If target hosts have sequential names (for example, host001, host002, host003, etc), you can skip the hosts.txt file and use the seq command like this:</p>

<p><tt>$ export AGENT=hyperic-hq-agent-4.0.0-x86-linux.tgz</tt><br/>
<tt>$ for i in `seq 1 9`; do scp $AGENT host$i: &amp;&amp; ssh host$i "tar zxf $AGENT &amp;&amp; ./hyperic-hq-agent-4.0.0/hq-agent.sh start"; done</tt></p></blockquote>


<h1><a name="DeployingMultipleHypericAgents-VerifySuccessfulAgentStartup"></a>Verify Successful Agent Startup</h1>

<p>After successfully registering itself with the Hyperic Server, an Hyperic Agent runs an autoscan, and should discover its host platform, and supported servers managed products. Check the Auto-Discovery portlet in the Hyperic Dashboard to verify the the platforms were discovered.</p>

<p>If you have problems, see <a href="Troubleshoot Agent and Server Problems.html" title="Troubleshoot Agent and Server Problems">Troubleshoot Agent and Server Problems</a>.</p>

<div class="scroll-pagebreak"></div>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 28, 2011 15:25</font></td>
		    </tr>
	    </table>
    </body>
</html>
