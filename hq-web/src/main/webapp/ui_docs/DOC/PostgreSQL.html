<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>vFabric Hyperic 5.7 : PostgreSQL</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
<b><a href="vFabric Hyperic 5.7.html" title="vFabric Hyperic 5.7 Documentation Home">vFabric Hyperic 5.7 Documentation Home (Internal)</a>
 - <a href="https://www.vmware.com/support/pubs/vfabric-hyperic.html">vFabric Hyperic 5.7 Documentation Home (Online)</a>
 -  <a href="https://www.vmware.com/support/vfabric-hyperic/doc/vfabric-hyperic-rn-5.0.html">Hyperic 5.7 Release Notes</a> </b>
 <p>
 <p>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            vFabric Hyperic 5.7 : PostgreSQL
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Aug 31, 2012 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <style type='text/css'>/*<![CDATA[*/
div.rbtoc1346441541605 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1346441541605 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1346441541605 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1346441541605'>
<ul>
    <li><a href='#PostgreSQL-PostgreSQLPluginOverview'>PostgreSQL Plugin Overview</a></li>
<ul>
    <li><a href='#PostgreSQL-SupportedVersionsandRequirements'>Supported Versions and Requirements</a></li>
    <li><a href='#PostgreSQL-PostgreSQLResourcesandtheHypericInventoryModel'>PostgreSQL Resources and the Hyperic Inventory Model</a></li>
</ul>
    <li><a href='#PostgreSQL-ConfigurationInstructions'>Configuration Instructions</a></li>
<ul>
    <li><a href='#PostgreSQL-Step1%3AInstallHypericAgent'>Step 1: Install Hyperic Agent</a></li>
    <li><a href='#PostgreSQL-Step2%3AImportPostgreSQLServer'>Step 2: Import PostgreSQL Server</a></li>
    <li><a href='#PostgreSQL-Step3%3AConfigureResourceNameFormat%28Optional%29'>Step 3: Configure Resource Name Format (Optional)</a></li>
    <li><a href='#PostgreSQL-Step4%3AConfigurePostgreSQLServerinHyperic'>Step 4: Configure PostgreSQL Server in Hyperic</a></li>
    <li><a href='#PostgreSQL-Step5%3AVerifyMetricCollection'>Step 5: Verify Metric Collection</a></li>
</ul>
    <li><a href='#PostgreSQL-ResourceTypesandManagementFunctions'>Resource Types and Management Functions</a></li>
<ul>
    <li><a href='#PostgreSQL-AutoDiscovery'>Auto-Discovery</a></li>
    <li><a href='#PostgreSQL-Measurement'>Measurement</a></li>
    <li><a href='#PostgreSQL-Control'>Control</a></li>
    <li><a href='#PostgreSQL-ConfigurationTracking'>Configuration Tracking</a></li>
</ul>
    <li><a href='#PostgreSQL-PostgreSQLMetrics'>PostgreSQL Metrics</a></li>
</ul></div>

<h1><a name="PostgreSQL-PostgreSQLPluginOverview"></a>PostgreSQL Plugin Overview</h1>

<p>Hyperic's PostgreSQL plugin manages PostgreSQL and vPostgreSQL.</p>

<p>The indented list below illustrates the hierarchy of Hyperic resource types that map to PostgreSQL and vPostgreSQL entities.  Note that, as of Hyperic 5.7, the PostgreSQL plugin can discover and monitor multiple databases running in the same PostgreSQL server.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">PostgreSQL
     PostgreSQL Database
     PostgreSQL Table
     PostgreSQL Index
vPostgreSQL
     vPostgreSQL Database
     vPostgreSQL Table
     vPostgreSQL Index</pre>
		</div>
</div></div>

<h2><a name="PostgreSQL-SupportedVersionsandRequirements"></a>Supported Versions and Requirements</h2>

<p>The PostgreSQL plugin supports:</p>
<ul>
	<li>vPostgreSQL 9.x</li>
	<li>PostgreSQL 9.x</li>
	<li>PostgreSQL 8.x</li>
	<li>PostgreSQL 7.4</li>
</ul>


<h2><a name="PostgreSQL-PostgreSQLResourcesandtheHypericInventoryModel"></a>PostgreSQL Resources and the Hyperic Inventory Model</h2>

<p>PostgreSQL and vPosteSQL resources are server types. The Database, Table, and Index resources are service types.</p>


<h1><a name="PostgreSQL-ConfigurationInstructions"></a>Configuration Instructions</h1>

<p>This sections below have instructions for configuring Hyperic to manage PostegreSQL.</p>

<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Remove existing PostgreSQL resources</b><br />If you have used a previous version of Hyperic's PostgreSQL plugin, you must delete all existing PostreSQL servers and services from Hyperic inventory prior to using the 5.0 version of the plugin.</td></tr></table></div>

<h2><a name="PostgreSQL-Step1%3AInstallHypericAgent"></a>Step 1: Install Hyperic Agent</h2>

<p>If you have not already done so, install a Hyperic Agent on the PostgreSQL or vPostgreSQL host. See <a href="Install an Agent-Only Package.html" title="Install an Agent-Only Package">Install an Agent&#45;Only Package</a> in <em>Getting Started with vFabric Hyperic</em> for instructions.</p>

<h2><a name="PostgreSQL-Step2%3AImportPostgreSQLServer"></a>Step 2: Import PostgreSQL Server</h2>

<p>After you start the Hyperic Agent, it should discover the PostgreSQL or vPostgreSQL server. The server should appear in the <b>Auto-Discovery</b> portlet on the Hyperic Dashboard. Import the server.</p>


<h2><a name="PostgreSQL-Step3%3AConfigureResourceNameFormat%28Optional%29"></a>Step 3: Configure Resource Name Format (Optional)</h2>

<p>The format of resource names that the PostgreSQL plugin assigns to PostgreSQL servers, databases, schemas and tables can be configured using agent properties.</p>

<p>The default name formats for PostgreSQL resources are documented below in <a href="#PostgreSQL-AutoDiscovery">Auto&#45;Discovery</a>. </p>

<p> If you would like to use a different naming convention, define the desired format with these agent properties:</p>

<ul>
	<li><tt><a href="postgresql.server.name.format.html" title="postgresql.server.name.format">postgresql.server.name.format</a></tt></li>
	<li><tt><a href="postgresql.database.name.format.html" title="postgresql.database.name.format">postgresql.database.name.format</a></tt></li>
	<li><tt><a href="postgresql.index.name.format.html" title="postgresql.index.name.format">postgresql.index.name.format</a></tt></li>
	<li><tt><a href="postgresql.table.name.format.html" title="postgresql.table.name.format">postgresql.table.name.format</a></tt></li>
</ul>


<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Why and when configure resource name formats?</b><br />If the plugin will only manage a single database, you can shorten schema and table names by removing the segment that identifies the associated database from the <tt>postgresql.index.name.format</tt> and <tt>postgresql.table.name.format</tt> properties. 

<p>Note that if you configure a different format for PostgreSQL resources after importing resources with the default names you will have  duplicate resources in the Hyperic database. You can avoid this problem be deleting the existing resources from Hyperic before changing resource name properties.</p></td></tr></table></div>


<h2><a name="PostgreSQL-Step4%3AConfigurePostgreSQLServerinHyperic"></a>Step 4: Configure PostgreSQL Server in Hyperic</h2>

<ol>
	<li>Navigate to the <b>Configuration Properties</b> page for the PostgreSQL server instance.<br/>
<span class="image-wrap" style=""><img src="attachments/79660206/80281655.png" width="750pxpx" style="border: 0px solid black"/></span></li>
	<li>Enter the username for connecting to PostgreSQL in the <b>postgresql.user</b> field.</li>
	<li>Enter password for connecting to PostgreSQL in the <b>postgresql.password</b> field.</li>
	<li>To limit the PostgreSQL tables that the Hyperic Agent will discover, enter a regular expression in the <b>postgresql.table.regex</b> field.
	<ul>
		<li>With the default value &#8212; <tt>ALL</tt> &#8212; all tables will be discovered.</li>
	</ul>
	</li>
	<li>To limit the PostgreSQL indexes that the Hyperic Agent will discover, enter a regular expression in the <b>postgresql.indexregex</b> field.
	<ul>
		<li>With the default value &#8212; <tt>OFF</tt> &#8212; no indexes will be discovered.</li>
	</ul>
	</li>
	<li>To enable configuration tracking, checkmark the <b>server.config_track.enable</b> box.
	<ul>
		<li>Configuration tracking for PostgreSQL is disabled by default.</li>
		<li>For information about the default tracking filter, see <a href="#PostgreSQL-Configtrack">Configuration Tracking</a> below.</li>
		<li>For information about how to enable configuration tracking and how to specify which files to track, see <a href="Set Up Configuration Tracking for a Resource.html" title="Set Up Configuration Tracking for a Resource">Set Up Configuration Tracking for a Resource</a> in <em>vFabric Hyperic Administration</em>.</li>
	</ul>
	</li>
	<li>If you do not want the agent to auto-discover PostgreSQL services (databases, tables, and indexes) and databases, uncheck the "Autodiscover Databases, indexes, and other services?&#42; box.</li>
</ol>


<h2><a name="PostgreSQL-Step5%3AVerifyMetricCollection"></a>Step 5: Verify Metric Collection</h2>

<p>Metrics should appear on the <b>Monitor</b> tab for a PostgreSQL resource.</p>

<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Troubleshooting metric collection</b><br />Hyperic's PostgreSQL plugin uses the PostgreSQL statistics collector to obtain metrics. Verify that the following parameter in <tt>PostgreSQLHome/data/postgresql.conf</tt> is set to its default value:

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">track_counts = true</pre>
		</div>
</div></div>
<p>If you do need to edit <tt>postgresql.conf</tt>, be sure to restart PostgreSQL after saving your changes.</p></td></tr></table></div>

<h1><a name="PostgreSQL-ResourceTypesandManagementFunctions"></a>Resource Types and Management Functions</h1>

<p>This section describes the management functions the PostgreSQL plugin performs for PostgreSQL components.</p>

<p><a name="PostgreSQL-AutoDiscovery"></a></p>

<h2><a name="PostgreSQL-AutoDiscovery"></a>Auto-Discovery</h2>

<p>The PostgreSQL plugin discovers server resources using a SIGAR query &#8212; it looks for a process named "postgres" or "postmaster".</p>

<p>After you configure the username and password for connecting to PostgreSQL, databases, tables, and indexes are auto-discovered.</p>

<p>The tables below shows the default conventions for how the PostgreSQL plugin names the resources it discovers.</p>

<p>For PostgreSQL and vPostgreSQL resources:</p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Resource Type </th>
<th class='confluenceTh'>Name Format </th>
<th class='confluenceTh'> Example </th>
</tr>
<tr>
<td class='confluenceTd'><ul>
	<li>vPostgreSQL <br class="atl-forced-newline" /></li>
	<li>PostgreSQL</li>
</ul>
</td>
<td class='confluenceTd'><em>Host:Port</em> </td>
<td class='confluenceTd'>12.555.55.55.Local:5432 </td>
</tr>
<tr>
<td class='confluenceTd'><ul>
	<li>vPostgreSQL Database <br class="atl-forced-newline" /></li>
	<li>PostgreSQL Database</li>
</ul>
</td>
<td class='confluenceTd'>Database <em>Database</em> </td>
<td class='confluenceTd'>Database ContractAPAC</td>
</tr>
<tr>
<td class='confluenceTd'><ul>
	<li>vPostgreSQL Table <br class="atl-forced-newline" /></li>
	<li>PostgreSQL Table</li>
</ul>
</td>
<td class='confluenceTd'>Table <em>Database.Schema.Table</em> </td>
<td class='confluenceTd'>Table ContractAPAC.Contract.Customer </td>
</tr>
<tr>
<td class='confluenceTd'><ul>
	<li>vPostgreSQL Index <br class="atl-forced-newline" /></li>
	<li>PostgreSQL Index</li>
</ul>
</td>
<td class='confluenceTd'>Index <em>Database.Schema.Index</em>  </td>
<td class='confluenceTd'>Index ContractAPAC.Contract.Customer.CustID </td>
</tr>
</tbody></table>
</div>


<p>For HQ PostgreSQL and vPostgreSQL resources:</p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'>Resource Type </th>
<th class='confluenceTh'>Name Format </th>
<th class='confluenceTh'> Example </th>
</tr>
<tr>
<td class='confluenceTd'>HQ PostgreSQL </td>
<td class='confluenceTd'><em>Host:Port</em> </td>
<td class='confluenceTd'>12.555.55.55.Local:5432 </td>
</tr>
<tr>
<td class='confluenceTd'>HQ PostgreSQL Database  </td>
<td class='confluenceTd'>Database <em>Database</em> </td>
<td class='confluenceTd'>Database HQ</td>
</tr>
<tr>
<td class='confluenceTd'>HQ PostgreSQL Table </td>
<td class='confluenceTd'>Table <em>Table</em> </td>
<td class='confluenceTd'>Table EAM_PLATFORM  </td>
</tr>
<tr>
<td class='confluenceTd'>HQ PostgreSQL Index  </td>
<td class='confluenceTd'>Index <em>Index</em>  </td>
<td class='confluenceTd'>Index Index FQDN </td>
</tr>
</tbody></table>
</div>



<p><a name="PostgreSQL-Measurement"></a></p>

<h2><a name="PostgreSQL-Measurement"></a>Measurement</h2>

<p>The PostgreSQL plugin uses the following measurement classes:</p>
<ul>
	<li><tt>DataBaseMeasurementPlugin.java</tt></li>
	<li><tt>ResourceMeasurement.java</tt></li>
	<li><tt>TableMeasurementPlugin.java</tt></li>
	<li><tt>PostgreSQL.java</tt></li>
	<li><tt>ServerMeasurement.java</tt> &#8212; uses SIGAR to obtain operating system statistics such as CPU and memory usage.</li>
</ul>


<p>Note that some metrics, for instance "Index Space Used" and "Database Space Used" are only incremented after a PostgreSQL <tt>vacuum</tt> or <tt>analyze</tt> operation is performed.</p>

<p><a name="PostgreSQL-Control"></a></p>

<h2><a name="PostgreSQL-Control"></a>Control</h2>

<p>The following control actions are available for PostgreSQL servers:</p>
<ul>
	<li>Stop</li>
	<li>Start</li>
</ul>


<p>The following control actions are available for PostgreSQL database and table services:</p>
<ul>
	<li>Analyze</li>
	<li>Vacuum</li>
	<li>VacuumAnalyze</li>
	<li>Reindex</li>
</ul>


<p>The following control action is available for PostgreSQL index services:</p>
<ul>
	<li>Reindex</li>
</ul>


<p><a name="PostgreSQL-ConfigTrack"></a></p>

<h2><a name="PostgreSQL-ConfigurationTracking"></a>Configuration Tracking</h2>

<p>The support class that the PostgreSQL plugin uses for configuration tracking &#8212;  <tt>org.hyperic.hq.product.FileChangeTrackPlugin</tt>  &#8212; enables detailed change tracking: the change type ("add", "delete", "modify", or "rename") and the actual changes in text files. For information about the new support class, see <tt><a href="FileChangeTrackPlugin.html" title="FileChangeTrackPlugin">FileChangeTrackPlugin</a></tt>.</p>

<p>For PostgreSQL, the default the default value of the <b>Configuration Files</b> field, which specifies which files to track is:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">data;false;.*\.conf;,*PGDATA*;false;.*\.conf;,data;false;.*\.conf;</pre>
		</div>
</div></div>

<p>When configuration tracking is enabled, this filter causes Hyperic to track:</p>
<ul>
	<li>In the <tt>PostgresqlHome/data</tt> directory, any files with a <tt>.conf</tt> extension.</li>
	<li>In the configuration directory specified by the <tt>PGDATA</tt> environment variable, and any files with a <tt>.conf</tt> extension.</li>
	<li>In the <tt>PostgresqlHome/data</tt> directory, any files with a <tt>.conf</tt> extension.</li>
</ul>


<h1><a name="PostgreSQL-PostgreSQLMetrics"></a>PostgreSQL Metrics</h1>

<ul><li><a href="vPostgres 9.x server.html" title="vPostgres 9.x server">vPostgres 9.x server</a><ul><li><a href="vPostgres 9.x Table service.html" title="vPostgres 9.x Table service">vPostgres 9.x Table service</a></li><li><a href="vPostgres 9.x Index service.html" title="vPostgres 9.x Index service">vPostgres 9.x Index service</a></li><li><a href="vPostgres 9.x DataBase service.html" title="vPostgres 9.x DataBase service">vPostgres 9.x DataBase service</a></li></ul></li><li><a href="PostgreSQL 9.x server.html" title="PostgreSQL 9.x server">PostgreSQL 9.x server</a><ul><li><a href="PostgreSQL 9.x DataBase service.html" title="PostgreSQL 9.x DataBase service">PostgreSQL 9.x DataBase service</a></li><li><a href="PostgreSQL 9.x Index service.html" title="PostgreSQL 9.x Index service">PostgreSQL 9.x Index service</a></li><li><a href="PostgreSQL 9.x Table service.html" title="PostgreSQL 9.x Table service">PostgreSQL 9.x Table service</a></li></ul></li><li><a href="HQ PostgreSQL 9.x server.html" title="HQ PostgreSQL 9.x server">HQ PostgreSQL 9.x server</a><ul><li><a href="HQ PostgreSQL 9.x Table service.html" title="HQ PostgreSQL 9.x Table service">HQ PostgreSQL 9.x Table service</a></li><li><a href="HQ PostgreSQL 9.x DataBase service.html" title="HQ PostgreSQL 9.x DataBase service">HQ PostgreSQL 9.x DataBase service</a></li><li><a href="HQ PostgreSQL 9.x Index service.html" title="HQ PostgreSQL 9.x Index service">HQ PostgreSQL 9.x Index service</a></li></ul></li><li><a href="PostgreSQL 8.x server.html" title="PostgreSQL 8.x server">PostgreSQL 8.x server</a><ul><li><a href="PostgreSQL 8.x DataBase service.html" title="PostgreSQL 8.x DataBase service">PostgreSQL 8.x DataBase service</a></li><li><a href="PostgreSQL 8.x Table service.html" title="PostgreSQL 8.x Table service">PostgreSQL 8.x Table service</a></li><li><a href="PostgreSQL 8.x Index service.html" title="PostgreSQL 8.x Index service">PostgreSQL 8.x Index service</a></li></ul></li><li><a href="PostgreSQL 7.4 server.html" title="PostgreSQL 7.4 server">PostgreSQL 7.4 server</a><ul><li><a href="PostgreSQL 7.4 Table service.html" title="PostgreSQL 7.4 Table service">PostgreSQL 7.4 Table service</a></li><li><a href="PostgreSQL 7.4 Index service.html" title="PostgreSQL 7.4 Index service">PostgreSQL 7.4 Index service</a></li><li><a href="PostgreSQL 7.4 DataBase service.html" title="PostgreSQL 7.4 DataBase service">PostgreSQL 7.4 DataBase service</a></li></ul></li></ul>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Oct 29, 2012 13:01</font></td>
		    </tr>
	    </table>
    </body>
</html>
