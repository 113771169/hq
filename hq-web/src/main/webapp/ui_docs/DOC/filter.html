<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Hyperic 4.6 Documentation : filter</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Hyperic 4.6 Documentation : filter
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 07, 2011 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <p><font color="gray"><em>Topics marked with</em></font> <font color="red">*</font> <font color="gray"><em>relate to features available only in vFabric Hyperic.</em></font></p>


<style type='text/css'>/*<![CDATA[*/
div.rbtoc1307466566326 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1307466566326 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1307466566326 li {margin-left: 0px;padding-left: 0px;}

/*]] >*/</style><div class='rbtoc1307466566326'>
<ul>
    <li><a href='#filter-ElementOverview'>Element Overview</a></li>
    <li><a href='#filter-ParentElements'>Parent Elements</a></li>
    <li><a href='#filter-ChildElementsandAttributes'>Child Elements and Attributes</a></li>
    <li><a href='#filter-Examples'>Examples</a></li>
<ul>
    <li><a href='#filter-filterdefinesmetrictemplatecomponentsusingconfigurationandmetricalias'>filter defines metric template components using configuration and metric alias</a></li>
    <li><a href='#filter-filterdefinesmetrictemplateusingavaluessuppliedbyapropertyandametricaliasattribute'>filter defines metric template using a values supplied by a property and a metric alias attribute</a></li>
    <li><a href='#filter-filterreferencesgloballyavailableconfigurationschema'>filter references globally available configuration schema</a></li>
    <li><a href='#filter-filterusesvalueofconfigoptiontoprovidedomainportionofmetrictemplate'>filter uses value of config option to provide domain portion of metric template</a></li>
</ul>
</ul></div>

<h1><a name="filter-ElementOverview"></a>Element Overview</h1>

<p>The <tt>&lt;filter&gt;</tt> element declares a variable that can be referenced by descendent elements in the descriptor to obtain resource-type specific values for other expressions. The most common use for the <tt>&lt;filter&gt;</tt> element is to define a string that forms all or a portion of the <tt>template</tt> attribute for <tt>&lt;metric&gt;</tt> elements, instead of explicitly defining the <tt>template</tt> for each metric.</p>

<p>A <tt>&lt;filter&gt;</tt> element is available to all descendants of its parent. For example, a <tt>&lt;filter&gt;</tt> definition in the plugin root applies to all <tt>&lt;platform&gt;</tt>, <tt>&lt;server&gt;</tt> and <tt>&lt;service&gt;</tt> elements that follow. You override the filter value a child inherits from a parent by defining a filter of the same name in the child element.</p>

<h1><a name="filter-ParentElements"></a>Parent Elements</h1>

<ul>
	<li><tt>&lt;plugin&gt;</tt> (root) - A <tt>&lt;filter&gt;</tt> element here is available to all resource elements in the descriptor</li>
</ul>


<ul>
	<li><tt>&lt;platform&gt;</tt> &#45; A <tt>&lt;filter&gt;</tt> element here is available  within the element and its descendants.</li>
</ul>


<ul>
	<li><tt>&lt;server&gt;</tt> &#45; A <tt>&lt;filter&gt;</tt> element here is available within the element and its descendants.</li>
</ul>


<ul>
	<li><tt>&lt;service&gt;</tt> &#45; A <tt>&lt;filter&gt;</tt> element here is available only within the element.</li>
</ul>


<h1><a name="filter-ChildElementsandAttributes"></a>Child Elements and Attributes</h1>

<ul>
	<li><tt>name</tt> &#45; (Required) Name by which the variable is referenced.  The name can be an arbitrary value, or exactly match the name of an attribute the filter defines.  Typically the name attribute defines a filter named "template" which defines the template attribute forelements using other variables whose values are assigned at the resource and metric level.</li>
</ul>


<ul>
	<li><tt>value</tt> &#45; (Required) Value of the variable, expressed explicitly or using other variables.</li>
</ul>


<h1><a name="filter-Examples"></a>Examples</h1>


<h2><a name="filter-filterdefinesmetrictemplatecomponentsusingconfigurationandmetricalias"></a>filter defines metric template components using configuration and metric alias</h2>

<p>This excerpt from the HQ Zimbra plugin, is part of a <tt>&lt;server&gt;</tt> element that defines:</p>

<ul>
	<li>a <tt>&lt;filter</tt> named "template" that specifies a building block in terms of the <tt>installpath</tt> configuration option and the <tt>metric</tt> element's <tt>alias</tt> attribute.</li>
</ul>


<ul>
	<li>an <tt>&lt;option&gt;</tt> element that defines the <tt>installpath</tt> configuration option.</li>
</ul>



<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;server name="Zimbra"
     version="4.5.x"&gt;

        &lt;plugin type="autoinventory"
         class="ZimbraServerDetector"/&gt;
        &lt;plugin type="measurement"
         class="org.hyperic.hq.product.MeasurementPlugin"/&gt;
        &lt;plugin type="collector"
         class="org.hyperic.hq.plugin.zimbra.ZimbraCollector"/&gt;

        &lt;filter name="template"
         value="zimbra-stats:installpath=%installpath%:${alias}"/&gt;

        &lt;properties&gt;
            &lt;property name="version"
             description="Zimbra Version"/&gt;
        &lt;/properties&gt;

        &lt;config&gt;
            &lt;option name="installpath"
             default="/opt/zimbra"
             description="Zimbra Install Path"/&gt;
            &lt;option name="zimbra-ptql"
             default="Pid.PidFile.eq=%installpath%/log/zmtomcatmgr.pid"
             description="Sigar PTQL Process Query"/&gt;
        &lt;/config&gt;</pre>
		</div>
</div></div>


<h2><a name="filter-filterdefinesmetrictemplateusingavaluessuppliedbyapropertyandametricaliasattribute"></a>filter defines metric template using a values supplied by a property and a metric alias attribute</h2>

<p>This element from the HQ Resin plugin defines a filter named template that references the values of a resource named OBJECT_NAME and a element's alias attribute. This reference provides two components of the metric template:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;filter name="template"
value="${OBJECT_NAME}:${alias}"
/&gt;</pre>
		</div>
</div></div>
<p>Because the filter is defined in the root <tt>&lt;plugin&gt;</tt> element, it is available to all resource elements in the descriptor.</p>

<p>The value of the OBJECT_NAME property is defined in each resource element in the descriptor, a <tt>&lt;server&gt;</tt> and two{{ &lt;service&gt;}} elements.  For example:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;service name="Port"&gt;
&lt;property name="OBJECT_NAME"
value="resin:type=Port,name=*"/&gt;</pre>
		</div>
</div></div>
<p>The template filter is expanded for each server and service metric, using the value of the owning resource's OBJECT_NAME property and the metric's alias attribute.</p>

<h2><a name="filter-filterreferencesgloballyavailableconfigurationschema"></a>filter references globally available configuration schema</h2>

<p>This excerpt shows the use of a globally available configuration schema in a filter:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;filter name="iplanet.snmp"
value="iplanet:$\{snmp.config\}"/&gt;</pre>
		</div>
</div></div>
<p>The "snmp" schema is defined in the HQ Netservices plugin descriptor, as shown in this excerpt:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">description="SNMP agent IP address"
default="127.0.0.1"/&gt;
description="SNMP agent port"
type="port"
default="161"/&gt;
description="SNMP Version"
type="enum"&gt;</pre>
		</div>
</div></div>
<p>In the filter definition,</p>

<p><tt>${snmp.config</tt>} is replaced by:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">snmpIP=*,snmpPort=*,*snmpVersion=*</pre>
		</div>
</div></div>

<p>resulting in:</p>

<p><tt>iplanet:snmpIP=,snmpPort=,snmpVersion=&#42;</tt></p>

<p>In the same plugin descriptor, the filter is referenced in a template definition:</p>

<p><tt>template="${iplanet.snmp}:httpStatisticsRequests:${server.config.v4}"</tt></p>

<h2><a name="filter-filterusesvalueofconfigoptiontoprovidedomainportionofmetrictemplate"></a>filter uses value of config option to provide domain portion of metric template</h2>

<p>The HQ  mssql-plugin descriptor defines several filters in the root, based on configuration options:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;plugin name="mssql"&gt;
  	......
	......
  &lt;filter name="db.domain"
          value="Databases(${db.name})"/&gt;
  &lt;filter name="lock.domain"
          value="Locks(${lock.name})"/&gt;
  &lt;filter name="cache.domain"
          value="Cache Manager(${cache.name})"/&gt;
  .....
  .....</pre>
		</div>
</div></div>
<p>Also in the root, <tt>&lt;metric&gt;</tt> elements, define the <tt>template</tt> in terms of the filter:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;metrics name="mssql-avail"&gt;
    &lt;metric name="Availability"
            alias="Availability"
            template="${db.domain}:Type=Availability:Active Transactions"
            category="AVAILABILITY"
            group="Reliability"
            indicator="true"
            collectionType="dynamic"
            units="percentage"/&gt;
  &lt;/metrics&gt;</pre>
		</div>
</div></div>
<p>Later in the descriptor, each resource element, like this <tt>&lt;service&gt;</tt> element, defines the <tt>&lt;option&gt;</tt>:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">&lt;service name="Database"&gt;
        ......
        ......
      &lt;config&gt;
        &lt;option name="db.name"
                description="Database name"
                default="Northwind"/&gt;
      &lt;/config&gt;
    &lt;/service&gt;</pre>
		</div>
</div></div>


<div class="scroll-pagebreak"></div>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 22, 2011 15:14</font></td>
		    </tr>
	    </table>
    </body>
</html>
