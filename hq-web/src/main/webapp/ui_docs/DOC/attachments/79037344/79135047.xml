<plugin>
  <property name="MIBDIR" value="/usr/share/snmp/mibs"/>

  <property name="MIBS"
            value="${MIBDIR}/NS-SMI.mib,${MIBDIR}/NS-RES.mib,${MIBDIR}/NS-INTERFACE.mib"/>

  <!-- for autoinventory plugin -->
  <classpath>
    <include name="pdk/plugins/netdevice-plugin.jar"/>
  </classpath>

  <platform name="NetScreen">

    <config include="snmp"/>

    <properties>
      <property name="sysContact"
                description="Contact Name"/>
      <property name="sysName"
                description="Name"/>
      <property name="sysLocation"
                description="Location"/>
      <property name="Version"
                description="Version"/>
    </properties>

    <plugin type="autoinventory"
            class="org.hyperic.hq.plugin.netdevice.NetworkDevicePlatformDetector"/>

    <plugin type="measurement"
            class="org.hyperic.hq.product.SNMPMeasurementPlugin"/>

    <property name="template" value="${snmp.template}:${alias}"/>

    <metric name="Availability"
            template="${snmp.template},Avail=true:sysUpTime"
            indicator="true"/>

    <metric name="Uptime"
            template="${snmp.template}:sysUpTime"
            category="AVAILABILITY"
            units="jiffys"
            defaultOn="true"
            collectionType="static"/>

    <metric name="Average CPU Utilization"
            alias="nsResCpuAvg"
            units="percent"/>

    <metric name="Average CPU Utilization (Last 1 min)"
            alias="nsResCpuLast1Min"
            units="percent"/>

    <metric name="Average CPU Utilization (Last 5 min)"
            alias="nsResCpuLast5Min"
            units="percent"/>

    <metric name="Average CPU Utilization (Last 15 min)"
            alias="nsResCpuLast15Min"
            indicator="true"
            units="percent"/>

    <metric name="Memory Allocated"
            alias="nsResMemAllocate"
            units="B"/>

    <metric name="Memory Left"
            alias="nsResMemLeft"
            indicator="true"
            units="B"/>

    <metric name="Memory Memory Fragment"
            alias="nsResMemFrag"
            units="B"/>

    <metric name="Sessions Allocated"
            alias="nsResSessAllocate"/>

    <metric name="Sessions Maximum"
            alias="nsResSessMaxium"/>

    <metric name="Sessions Failed"
            alias="nsResSessFailed"
            collectionType="trendsup"/>

    <!-- index to get table data -->
    <filter name="index"
            value="snmpIndexName=${snmpIndexName},snmpIndexValue=%snmpIndexValue%"/>

    <filter name="template"
            value="${snmp.template}:${alias}:${index}"/>

    <server>
      <plugin type="autoinventory"
              class="org.hyperic.hq.plugin.netdevice.NetworkDeviceDetector"/>

      <service name="Interface">
        <config>
          <option name="snmpIndexValue"
                  description="Interface name"/>
        </config>

        <property name="snmpIndexName" value="nsIfName"/>

        <plugin type="autoinventory"/>

        <properties>
          <property name="nsIfIp"
                    description="IP Address"/>
          <property name="nsIfNetmask"
                    description="Netmask"/>
          <property name="nsIfGateway"
                    description="Gateway"/>
        </properties>

        <metric name="Availability"
                template="${snmp.template},Avail=true:nsIfStatus:${index}"
                indicator="true"/>

        <!-- nsIfFlow* metrics -->
        <metric name="Bytes Received"
                alias="nsIfFlowInByte"
                indicator="true"
                collectionType="trendsup"
                category="THROUGHPUT"
                units="B"/>

        <metric name="Bytes Sent"
                alias="nsIfFlowOutByte"
                indicator="true"
                collectionType="trendsup"
                category="THROUGHPUT"
                units="B"/>

        <metric name="Packets Received"
                alias="nsIfFlowInPacket"
                collectionType="trendsup"
                category="THROUGHPUT"/>

        <metric name="Packets Sent"
                alias="nsIfFlowOutPacket"
                collectionType="trendsup"
                category="THROUGHPUT"/>

        <!-- nsIfMon* metrics -->
        <metric name="Auth Failures"
                alias="nsIfMonAuthFail"
                collectionType="trendsup"
                category="AVAILABILITY"/>
      </service>
    </server>
  </platform>
</plugin>
