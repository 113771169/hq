<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>vFabric Hyperic 4.6.5 : HQApi group command</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            vFabric Hyperic 4.6.5 : HQApi group command
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jan 04, 2012 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <p><font color="gray"><em>Topics marked with</em></font> <font color="red">*</font> <font color="gray"><em>relate to features available only in vFabric Hyperic.</em></font></p>

 
<style type='text/css'>/*<![CDATA[*/
div.rbtoc1325699196558 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1325699196558 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1325699196558 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1325699196558'>
<ul>
    <li><a href='#HQApigroupcommand-Functionality'>Functionality</a></li>
    <li><a href='#HQApigroupcommand-groupCommandOptions'>group Command Options</a></li>
<ul>
    <li><a href='#HQApigroupcommand-grouplist'>group list</a></li>
<ul>
    <li><a href='#HQApigroupcommand-grouplistCommandQualifiers'>group list Command Qualifiers</a></li>
    <li><a href='#HQApigroupcommand-StructureofaGroupsResponse'>Structure of a GroupsResponse</a></li>
    <li><a href='#HQApigroupcommand-AttributesinaGroupsResponse'>Attributes in a GroupsResponse</a></li>
</ul>
    <li><a href='#HQApigroupcommand-groupsync'>group sync</a></li>
<ul>
    <li><a href='#HQApigroupcommand-groupsyncCommandQualifiers'>group sync Command Qualifiers</a></li>
</ul>
    <li><a href='#HQApigroupcommand-groupdelete'>group delete</a></li>
<ul>
    <li><a href='#HQApigroupcommand-groupdeleteCommandQualifiers'>group delete Command Qualifiers</a></li>
</ul>
</ul>
    <li><a href='#HQApigroupcommand-Examples'>Examples</a></li>
<ul>
    <li><a href='#HQApigroupcommand-grouplist'>group list</a></li>
    <li><a href='#HQApigroupcommand-groupdelete'>group delete</a></li>
    <li><a href='#HQApigroupcommand-groupsyncviaXML'>group sync via XML</a></li>
    <li><a href='#HQApigroupcommand-groupsyncCreateorUpdateaCompatibleGroupfromCommandLine'>group sync - Create or Update a Compatible Group from Command Line</a></li>
    <li><a href='#HQApigroupcommand-groupsyncCreateorUpdateaMixedGroupfromCommandLine'>group sync - Create or Update a Mixed Group from Command Line</a></li>
</ul>
</ul></div> 
 
<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Related Topics</b><br />This page provides information for running an HQ API from the command line. Related topics include: 
<ul>
	<li><a href="vFabric Hyperic Web Services API.html" title="vFabric Hyperic Web Services API">vFabric Hyperic Web Services API</a> - brief introduction to the API.</li>
	<li><a href="HQApi Command-Line Tools.html" title="HQApi Command-Line Tools">HQApi Command&#45;Line Tools</a> - how to get started with the command line tools.</li>
	<li><a href="HQApi Java API.html" title="HQApi Java API">HQApi Java API</a> - about accessing the APIs programmatically.</li>
</ul>
</td></tr></table></div>  

 

<h1><a name="HQApigroupcommand-Functionality"></a>Functionality </h1>

<p>The <b>group</b> command has options to output resource group definitions, create or update groups, and delete groups. This is useful if you want to: </p>
<ul>
	<li>Review current resource group configurations.</li>
	<li>Make multiple changes to the configuration of groups in a single step.</li>
</ul>



<p>For information about groups in Hyperic, see <a href="Resources, Resource Types and Inventory Types.html#Resources%2CResourceTypesandInventoryTypes-groups">Resources, Resource Types and Inventory Types#groups</a>.</p>

<p>For information about groups in Hyperic, see "About Groups in Hyperic" in <em>vFabric Hyperic Administration</em>.</p>


<h1><a name="HQApigroupcommand-groupCommandOptions"></a>group Command Options </h1>

<h2><a name="HQApigroupcommand-grouplist"></a>group list </h2>
<p><a name="HQApigroupcommand-list"></a></p>

<p>The <b>group list</b> command returns a <tt>GroupsResponse</tt> element, which contains a contains a <tt>Group</tt> element (that defines the attributes of a group) for each group returned. </p>
<div class='panelMacro'><table class='tipMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/check.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>See <a href="Resources, Resource Types and Inventory Types.html" title="Resources, Resource Types and Inventory Types">Resources, Resource Types and Inventory Types</a>.</td></tr></table></div> 

<h3><a name="HQApigroupcommand-grouplistCommandQualifiers"></a>group list Command Qualifiers </h3>

<p>You can limit the groups returned by the <b>list</b> option with these qualifiers. </p>
<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Qualifier </th>
<th class='confluenceTh'> Description </th>
</tr>
<tr>
<td class='confluenceTd'> &#45;-compatible </td>
<td class='confluenceTd'> Only compatible groups are returned. </td>
</tr>
<tr>
<td class='confluenceTd'> &#45;-id </td>
<td class='confluenceTd'> The group with the specified ID is returned. </td>
</tr>
<tr>
<td class='confluenceTd'> &#45;-mixed </td>
<td class='confluenceTd'> Only mixed groups are returned. </td>
</tr>
<tr>
<td class='confluenceTd'> &#45;-name </td>
<td class='confluenceTd'> The group with the specified name is returned. </td>
</tr>
</tbody></table>
</div>


<h3><a name="HQApigroupcommand-StructureofaGroupsResponse"></a>Structure of a GroupsResponse </h3>

<p>The <tt>GroupsResponse</tt> element returned by the <b>group list &#45;-compatible</b> command has this element structure. </p>
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre> 
GroupsResponse 
Group 
ResourcePrototype 
Resource 
Role 
</pre>
</div></div> 
<p>where there is: </p>
<ul>
	<li>1 <tt>group</tt> element for each group returned</li>
	<li>0 or 1 <tt>ResourcePrototype</tt> elements; it is only present for a compatible group, in which case it specifies the resource type contained by the group.</li>
	<li>1 <tt>Resource</tt> element for each member of the group.</li>
	<li>(In vFabric Hyperic only) 1 <tt>Role</tt> element for each role that has access to the group.</li>
</ul>


<h3><a name="HQApigroupcommand-AttributesinaGroupsResponse"></a>Attributes in a GroupsResponse </h3>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Element </th>
<th class='confluenceTh'> Attribute </th>
<th class='confluenceTh'> Required to Create a Group? <br class="atl-forced-newline" /> </th>
<th class='confluenceTh'> Description </th>
<th class='confluenceTh'> Allowable Values </th>
</tr>
<tr>
<td class='confluenceTd'> <tt>Group</tt> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> resourceID </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> id </td>
<td class='confluenceTd'> no - do not supply <br class="atl-forced-newline" /> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> name </td>
<td class='confluenceTd'> yes </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> description </td>
<td class='confluenceTd'> no </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> location </td>
<td class='confluenceTd'> no <br class="atl-forced-newline" /> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> <tt>ResourcePrototype</tt> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> id </td>
<td class='confluenceTd'> yes - for a compatible group <br class="atl-forced-newline" /> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> name </td>
<td class='confluenceTd'> no <br class="atl-forced-newline" /> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> <tt>Resource</tt> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> id </td>
<td class='confluenceTd'> yes </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> name </td>
<td class='confluenceTd'> no </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'> <tt>Role</tt> </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> id </td>
<td class='confluenceTd'> yes </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> name </td>
<td class='confluenceTd'> no </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
<tr>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'> description </td>
<td class='confluenceTd'> no </td>
<td class='confluenceTd'>&nbsp;</td>
<td class='confluenceTd'>&nbsp;</td>
</tr>
</tbody></table>
</div>


<h2><a name="HQApigroupcommand-groupsync"></a>group sync </h2>

<p>The <b>group sync</b> command creates or updates group definitions in Hyperic using the content of a <tt>GroupsResponse</tt> element. </p>

<p>This is how <b>group sync</b> works: </p>

<ul>
	<li>You can supply the values to sync a group in an XML file or via command line arguments; the latter capability is&nbsp;a functional replacement for the Hyperic Mass plugin, which is deprecated.</li>
	<li>All attributes in the <tt>Group</tt> element, except <tt>id</tt>, can be updated. (When you create a new group, Hyperic assigns the <tt>id</tt>.)</li>
	<li>The <tt>ResourcePrototype</tt> cannot be changed once the group is created. Attempts to update this will result in a not supported error. <b>group sync</b> only adds resources to a group, unless you use the <tt>&#45;-deleteMissing</tt> qualifier.</li>
	<li>The roles assigned to the group are completely updated based on the <tt>Role</tt> elements present. If you delete a <tt>Role</tt> element, the <b>sync</b> will remove that role from the group.</li>
</ul>


<h3><a name="HQApigroupcommand-groupsyncCommandQualifiers"></a>group sync Command Qualifiers </h3>

<p>This table defines the command qualifiers you can use to define or update a group from the command line in Hyperic 4.3 and later. </p>

<div class='table-wrap'>
<table class='confluenceTable'><tbody>
<tr>
<th class='confluenceTh'> Qualifier </th>
<th class='confluenceTh'> Description </th>
</tr>
<tr>
<td class='confluenceTd'> <tt>--addRole</tt> </td>
<td class='confluenceTd'> Use in conjunction with the <tt>name</tt> qualifier. Use <tt>addRole</tt> to add a role to the group whose name is defined by <tt>name</tt>. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--children</tt> </td>
<td class='confluenceTd'> For filtering group membership. Causes the children of the resources that match other specified filters to be added to the group. The new or updated group will contain the resources that match the membership filter criteria, and also the children of those resources. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--clear</tt> </td>
<td class='confluenceTd'> For removing all resources from an existing group. The updated group will have no resources. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--clearRoles</tt> </td>
<td class='confluenceTd'> Use in conjunction with the <tt>name</tt> qualifier. Use <tt>clearRoles</tt> to remove all roles from the group whose name is defined by <tt>name</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--compatible</tt> </td>
<td class='confluenceTd'> If specified, attempt to make the group compatible </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--delete</tt> </td>
<td class='confluenceTd'> For removing selected resources from an existing group. Resources that match the filter criteria will be removed from the group. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--deleteMissing</tt> </td>
<td class='confluenceTd'> This switch controls how <b>sync</b> behaves when run on an existing group: the updated group will contain only resources that match the specified filter criteria &#8212; existing group members that do not match the filter criteria will be removed from the group. Use <tt>deleteMissing</tt> if you want to to completely re-specify the rules for membership in the group. If instead, you wish to simply add additional resources to the group, do not use <tt>deleteMissing</tt> </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--description</tt> </td>
<td class='confluenceTd'> Description of the group to create or update. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--name</tt> </td>
<td class='confluenceTd'> Name of the group to create or update. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--platform</tt> </td>
<td class='confluenceTd'> For filtering group membership. Limits the resources in the group to resources on the specified platform. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--prototype</tt> </td>
<td class='confluenceTd'> For filtering group membership. Limits the resources in the group to resources of the specified resource type - as identified by Hyperic's internal ID for the resource type. </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--regex</tt> </td>
<td class='confluenceTd'> For filtering group membership. Limits the resources in the group to resources whose resource type matches the regex </td>
</tr>
<tr>
<td class='confluenceTd'> <tt>--removeRole</tt> </td>
<td class='confluenceTd'> Use in conjunction with the <tt>name</tt> qualifier. Use <tt>removeRole</tt> to remove a role from the group whose name is defined by <tt>name</tt> </td>
</tr>
</tbody></table>
</div>


<h2><a name="HQApigroupcommand-groupdelete"></a>group delete </h2>

<p>The <b>delete</b> option deletes a single specified group from the Hyperic database.</p>

<h3><a name="HQApigroupcommand-groupdeleteCommandQualifiers"></a>group delete Command Qualifiers </h3>

<p>You must identify the group to be deleted using the <tt>--id</tt> qualifier to specify the group's internal ID. </p>

<h1><a name="HQApigroupcommand-Examples"></a>Examples </h1>


<h2><a name="HQApigroupcommand-grouplist"></a>group list </h2>

<p>The <tt>GroupsResponse</tt> element below defines two groups. The "All Servers" group is a mixed group, and is associated with the the "MgmtAdmin" role. (The roles feature is available only in vFabric Hyperic. </p>

<p>"File Mounts" is a compatible group, as indicated by the existence of the <tt>ResourcePrototype</tt> element. </p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">bash-3.2$ ./bin/hqapi.sh group list 
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt; 
&lt;GroupsResponse&gt; 
&lt;Status&gt;Success&lt;/Status&gt; 
&lt;Group location="" description="" name="All Servers" id="10001"&gt; 
&lt;Resource name="localhost HQ Agent 4.1.0-EE" id="10673"/&gt; 
&lt;Resource name="localhost HQ JBoss 4.x" id="10667"/&gt; 
&lt;Resource name="localhost PostgreSQL 8.2.5" id="10671"/&gt; 
&lt;Resource name="localhost Tomcat 6.0" id="10662"/&gt; 
&lt;Role name="MgmtAdmin" id="4"/&gt; 
&lt;/Group&gt; 
&lt;Group location="" description="" name="File Mounts" id="10002"&gt; 
&lt;ResourcePrototype name="FileServer Mount" id="10048"/&gt; 
&lt;Resource name="localhost MacOSX File System /dev/disk0s2 mounted on / (local/hfs)" id="10692"/&gt; 
&lt;Resource name="localhost MacOSX File System /dev/disk1s3 mounted on /Volumes/hyperic (local/hfs)" id="10694"/&gt; 
&lt;Resource name="localhost MacOSX File System /dev/disk1s5 mounted on /Volumes/spare (local/hfs)" id="10693"/&gt; 
&lt;/Group&gt; 
&lt;/GroupsResponse&gt;</pre>
		</div>
</div></div> 


<h2><a name="HQApigroupcommand-groupdelete"></a>group delete </h2>

<p>In this example the group whose internal id is 10002 is deleted. </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">$ ./bin/hqapi.sh group delete --id=10002 
Successfully deleted group id 10002 
$</pre>
		</div>
</div></div> 

<h2><a name="HQApigroupcommand-groupsyncviaXML"></a>group sync via XML </h2>

<p>In this example, the first command writes the all groups in Hyperic to a file called <tt>groups.xml</tt>. The second command sends the <tt>groups.xml</tt> to the <tt>sync</tt> method to update the groups in Hyperic. </p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">$ ./bin/hqapi.sh group list &gt; groups.xml 
... 
... 
$ cat groups.xml | ./bin/hqapi.sh group sync 
Successfully synced 2 groups.</pre>
		</div>
</div></div> 

<p>For more information about supplying values to <b>sync</b> using an XML file, see <p><b>Note:&nbsp;</b> When you use <b>sync</b> to create a new item, do not specify the <tt>id</tt> attribute for the new item. See <a href="HQApi Command-Line Tools.html#HQApiCommand-LineTools-sync">sync</a> for more information. </p> </p>

<h2><a name="HQApigroupcommand-groupsyncCreateorUpdateaCompatibleGroupfromCommandLine"></a>group sync - Create or Update a Compatible Group from Command Line </h2>

<p>The command below creates or updates a compatible group named "Disks - Web", adding FileServer Mounts whose name match the regular expression <tt>.web.</tt> and deleting any resources in the group that don't match criteria specified by <tt>prototype</tt> and <tt>regex</tt>. Because the <tt>--deleteMissing</tt> qualifier is included, after running this command the <em>only</em> resources in the group will be FileServer Mounts whose names match the regular expression <tt>.web.</tt>. If the group already exists, any resources that do not match the filter criteria are removed. </p>

<p><tt>group sync &#45;-name="Disks - Web" &#45;-prototype="FileServer Mount" &#45;-regex=".&#42;web.&#42;" &#45;-description="All Web Disks" &#45;-deleteMissing &#45;-compatible</tt> </p>

<h2><a name="HQApigroupcommand-groupsyncCreateorUpdateaMixedGroupfromCommandLine"></a>group sync - Create or Update a Mixed Group from Command Line </h2>

<p>To create a mixed group from the command line, run sync multiple times for the same group, with different filter criteria. Be sure not to specify <tt>&#45;-deleteMissing</tt> and <tt>&#45;-compatible</tt> when creating and updating a mixed group.</p>

<p>This command creates a mixed group that contains all the resources on a platform.&nbsp; </p>

<p><tt>group sync &#45;-name=Targol &#45;-platform=demo2.hypo.net &#45;-description=my group</tt> </p>

<p>To add more resources to the mixed group, run <b>group sync</b> again with appropriate filter criteria.</p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jan 20, 2012 10:07</font></td>
		    </tr>
	    </table>
    </body>
</html>
