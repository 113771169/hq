<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>vFabric Hyperic 4.6.5 : Configure a Custom Control Action</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
<b><a href="vFabric Hyperic 4.6.5.html" title="vFabric Hyperic 4.6.5 Documentation Home">vFabric Hyperic 4.6.5 Documentation Home (Internal)</a>
 - <a href="https://www.vmware.com/support/pubs/vfabric-hyperic.html">vFabric Hyperic 4.6.5 Documentation Home (Online)</a>
 -  <a href="https://www.vmware.com/support/vfabric-hyperic/doc/vfabric-hyperic-rn-4.6.5.html">Hyperic 4.6.5 Release Notes</a> </b>
 <p>
 <p>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            vFabric Hyperic 4.6.5 : Configure a Custom Control Action
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jan 04, 2012 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    <p><font color="gray"><em>Topics marked with</em></font> <font color="red">*</font> <font color="gray"><em>relate to features available only in vFabric Hyperic.</em></font></p>


<style type='text/css'>/*<![CDATA[*/
div.rbtoc1325699655383 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1325699655383 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1325699655383 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1325699655383'>
<ul>
    <li><a href='#ConfigureaCustomControlAction-Step1InstallExecutable'>Step 1 - Install Executable</a></li>
    <li><a href='#ConfigureaCustomControlAction-Step2ConfigureControlActionasaPlatformService'>Step 2 - Configure Control Action as a Platform Service</a></li>
</ul></div>




<p>This page has instructions for how to configure Hyperic to run a script or executable that implements a resource <em>control action</em>. To learn about control actions in Hyperic see <a href="Run Resource Control Actions.html" title="Run Resource Control Actions">Run Resource Control Actions</a>.</p>

<h1><a name="ConfigureaCustomControlAction-Step1InstallExecutable"></a>Step 1 - Install Executable</h1>

<p>Install the executable that implements the control action on each managed platform where it will be used. Note that the account under which the Hyperic Agent runs must have:</p>
<ul>
	<li>Adequate permissions to run the file.</li>
	<li>Adequate permissions to perform the tasks defined in the executable.</li>
</ul>


<p>You can control the permissions required to run the file with <tt>chmod</tt> or an equivalent utility in your environment. If the tasks defined in the executable require permissions not granted to the account the Hyperic Agent runs under, one option is to add specific "NOPASSWD" entries in the sudoers file on the platform.</p>

<p>As a best practice, create a "control_scripts" (or similar) directory in <tt>/opt/hyperic</tt>, or a directory high enough in the agent installation that it will not be overwritten during an agent upgrade.</p>

<h1><a name="ConfigureaCustomControlAction-Step2ConfigureControlActionasaPlatformService"></a>Step 2 - Configure Control Action as a Platform Service</h1>

<p>In this step, you must configure the means by which an authorized user can invoke the custom control action. To do so, you configure it as a platform service of type "FileServer File Service" on each platform where the action will be used. </p>

<ol>
	<li>Browse to the platform in the Resource Hub.</li>
	<li>Select "New Platform Service" from the <b>Tools</b> menu.</li>
	<li>Name the service.
	<ul>
		<li>Note: Including the platform name in the name for the new service will help you distinguish it from other services of the same type.</li>
	</ul>
	</li>
	<li>(Optional) Describe the functionality of the control action in "Description".</li>
	<li>Select "FileServer File" from the "Service Type" pulldown.</li>
	<li>Click <b>OK</b>.
	<ul>
		<li>The <b>Inventory</b> page for the new platform service appears.</li>
	</ul>
	</li>
	<li>Click <b>Edit</b> in the "Configuration Properties" section of the <b>Inventory</b> page.
	<ul>
		<li>The <b>Configuration Properties</b> page for the new platform service appears.<br/>
<span class="image-wrap" style=""><img src="attachments/79038211/79135473.png" width="750px" style="border: 0px solid black"/></span></li>
	</ul>
	</li>
	<li>On the <b>Configuration Properties</b> page:
	<ol>
		<li>path &#8212; Enter the path to the executable in the "path" field in the "Shared" section, including the name of the file itself. This can be a relative path if the executable is in the Hyperic Agent directory structure. A better practice is to store the script external to the agent directory structure, and specify the full path to the executable, for example, <tt>/opt/hyperic/control_scripts/test.sh</tt>.</li>
		<li>timeout &#8212; Check the value in the "timeout" field in the "Control" section. This is the time in seconds HQ will wait for a response from the control before declaring it as a failed action. The default is 30 seconds, and under most circumstances should be adequate.</li>
	</ol>
	</li>
	<li>If the executable requires higher privileges than those available to the account running the Hyperic Agent, you can use the "prefix" field in the "Control" section to specify the <tt>sudo</tt> command. In this case, the local sudoers file has an entry for the user to run the script with a NOPASSWD directive.</li>
	<li>Click <b>OK</b>.</li>
</ol>




				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Feb 15, 2012 15:42</font></td>
		    </tr>
	    </table>
    </body>
</html>
