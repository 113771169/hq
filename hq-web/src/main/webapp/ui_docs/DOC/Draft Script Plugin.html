<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>Hyperic 4.6 Documentation : Draft Script Plugin</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            Hyperic 4.6 Documentation : Draft Script Plugin
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Jun 07, 2011 by <font color="#0050B2">mmcgarry</font>.
				    </div>

				    
<style type='text/css'>/*<![CDATA[*/
div.rbtoc1307466543037 {margin-left: 1.5em;padding: 0px;}
div.rbtoc1307466543037 ul {list-style: disc;margin-left: 0px;padding-left: 20px;}
div.rbtoc1307466543037 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='rbtoc1307466543037'>
<ul>
    <li><a href='#DraftScriptPlugin-OverviewofScriptPlugins'>Overview of Script Plugins</a></li>
    <li><a href='#DraftScriptPlugin-WriteScript'>Write Script</a></li>
    <li><a href='#DraftScriptPlugin-SpecifyResourceHierarchy'>Specify Resource Hierarchy</a></li>
    <li><a href='#DraftScriptPlugin-SpecifyManagedResources'>Specify Managed Resources</a></li>
<ul>
    <li><a href='#DraftScriptPlugin-HowtoGetFindandAccesstheResource'>How to Get Find and Access the Resource</a></li>
    <li><a href='#DraftScriptPlugin-WhatInventoryPropertiestoObtainandPresent'>What Inventory Properties to Obtain and Present</a></li>
    <li><a href='#DraftScriptPlugin-WhatManagementFunctionstoPerformandHow'>What Management Functions to Perform and How</a></li>
</ul>
    <li><a href='#DraftScriptPlugin-SpecifyPluginFunctions'>Specify Plugin Functions</a></li>
<ul>
    <li><a href='#DraftScriptPlugin-AutoDiscovery'>Auto-Discovery</a></li>
    <li><a href='#DraftScriptPlugin-Measurement'>Measurement</a></li>
    <li><a href='#DraftScriptPlugin-SpecifyResourceProperties'>Specify Resource Properties</a></li>
    <li><a href='#DraftScriptPlugin-SpecifyMetrics'>Specify Metrics</a></li>
    <li><a href='#DraftScriptPlugin-SpecifyConfigurationOptions'>Specify Configuration Options</a></li>
</ul>
</ul></div>

<h1><a name="DraftScriptPlugin-OverviewofScriptPlugins"></a>Overview of Script Plugins</h1>

<p>A <em>script plugin</em> is a plugin that runs one or more scripts that return process metrics in  name:value pairs.  The components  of a script plugin are an XML plugin descriptor that defines the monitored process and its properties, along with the metrics that the script reports. You scan embed your script in the XML plugin descriptor, in which case you deploy only the XML file. If your script is in its own file, you reference in the descriptor, and deploy an archive containing the script and the descriptor. </p>

<p>You can write the script for a plugin in any scripting language you wish. You can use existing Nagios plugins if desired.</p>

<h1><a name="DraftScriptPlugin-WriteScript"></a>Write Script</h1>

<p>Write or select a script that returns desired resource metrics as name-value pairs. For example:</p>

<div class="code panel" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>Sample Script Output</b></div><div class="codeContent panelContent">
<div id="root">
		<pre class="theme: Confluence; brush: java; gutter: false">$ ${HQ_HOME}/plugins/scripts/script.pl 
Availability=0 
Metric=8192</pre>
		</div>
</div></div> 

<p>Put the script in <tt>AgentHome/bundles/AgentBundleDir/pdk/scripts/</tt>, or in the XML descriptor. </p>

<h1><a name="DraftScriptPlugin-SpecifyResourceHierarchy"></a>Specify Resource Hierarchy </h1>

<p>You define a resource element &#8212; a <tt>&lt;server&gt;</tt> or <tt>&lt;service&gt;</tt> element &#8212; for each of the resource types your script monitors. </p>

<p>If the script reports on a single service, model it as a platform service: specify it in a <tt>&lt;service&gt;</tt> element in the root <tt>&lt;plugin&gt;</tt> element of the descriptor.</p>

<p>If the script reports on a multiple services, model each as a service, and create a parent server resource to contain the services: specify the parent <tt>&lt;server&gt;</tt> element in the root <tt>&lt;plugin&gt;</tt> element of the descriptor, and the specify the each monitored service in a <tt>&lt;service&gt;</tt> element within the  <tt>&lt;server&gt;</tt> element.</p>

<h1><a name="DraftScriptPlugin-SpecifyManagedResources"></a>Specify Managed Resources</h1>

<h2><a name="DraftScriptPlugin-HowtoGetFindandAccesstheResource"></a>How to Get Find and Access the Resource</h2>

<p>A script plugin uses the <tt>DaemonDetector</tt> to discover resources from the process table &#8212; <tt>DaemonDetector</tt> runs a PTQL <tt>process.query</tt>.</p>

<p><tt>State.Name.eq=BaseName</tt></p>

<p>For a server type whose process name varies by vendor or platform, you can speciy a regular expression for BaseName. </p>

<p>To distinguish been a parent process and forked children, you use a PTQL query that excludes forked processes.</p>

<p>For a Java process, you typically need to specify command line arguments for the process to identify it.</p>





<h2><a name="DraftScriptPlugin-WhatInventoryPropertiestoObtainandPresent"></a>What Inventory Properties to Obtain and Present</h2>

<h2><a name="DraftScriptPlugin-WhatManagementFunctionstoPerformandHow"></a>What Management Functions to Perform and How</h2>



<h1><a name="DraftScriptPlugin-SpecifyPluginFunctions"></a>Specify Plugin Functions </h1>

<p>Within each <tt>&lt;server&gt;</tt> and <tt>&lt;service&gt;</tt> element specify a <tt>&lt;plugin&gt;</tt> element for each management function to be performed.</p>

<h2><a name="DraftScriptPlugin-AutoDiscovery"></a>Auto-Discovery</h2>

<p>&lt;plugin type="autoinventory"<br/>
            class="org.hyperic.hq.product.DaemonDetector"/&gt;</p>


<h2><a name="DraftScriptPlugin-Measurement"></a>Measurement </h2>
<h2><a name="DraftScriptPlugin-SpecifyResourceProperties"></a>Specify Resource Properties</h2>

<h2><a name="DraftScriptPlugin-SpecifyMetrics"></a>Specify Metrics </h2>

<h2><a name="DraftScriptPlugin-SpecifyConfigurationOptions"></a>Specify Configuration Options</h2>



				    					    <br/>
                        <div class="tabletitle">
                            <a name="attachments">
                                <h2>Attachments:</h2>
                            </a>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/76284370/76578835.gif">icon_available_red.gif</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/76284370/76578836.gif">icon_available_error.gif</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/76284370/76578837.gif">icon_available_green.gif</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/76284370/76578838.vbs">windows_updates.vbs</a> (application/octet-stream)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/76284370/76578839.gif">icon_available_yellow.gif</a> (image/gif)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/76284370/76578840.gif">icon_available_orange.gif</a> (image/gif)
                                <br/>
                                                    </div>
				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="http://support.hyperic.com/images/border/border_bottom.gif"><img src="images/border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Jun 14, 2011 15:09</font></td>
		    </tr>
	    </table>
    </body>
</html>
