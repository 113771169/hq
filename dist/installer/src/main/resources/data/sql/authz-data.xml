<?xml version="1.0" encoding="UTF-8"?>

<Covalent.DBSetup name="authz-data.xml" notice="DBSetup, Copyright (C) 2002, Covalent Technologies, Inc., All Rights Reserved.">


   

    <table name="EAM_SUBJECT">
        <data ID="0" NAME="admin" DSN="covalentAuthzInternalDsn"
              FIRST_NAME="System" LAST_NAME="User" DEPARTMENT="Administration" 
              FSYSTEM="TRUE" FACTIVE="TRUE" HTML_EMAIL="FALSE"/>
    </table>

  
<!-- TODO referencing resource w/ID 4-->
    <!--  <table name="EAM_SUBJECT">
        <data ID="0" RESOURCE_ID="%EAM_RESOURCE.ID:4"/>
    </table>-->

   
  

    <!-- End AppDef AUTHZ Entities -->

    <!-- ROOT ROLE DEFINITION STUFF. The entries here create a role
         which has all the authz permissions on the basic objects. 
         It is the equivalent to the overlord role, except that 
         the overlord is a single user which can do everything, and
         can not log in to the system -->

    <!-- create the root subject -->
    <!-- NOTE THIS ENTRY MUST BE CREATED BY THE INSTALLER IN THE RELEASE -->
    <table name="EAM_SUBJECT">
        <data ID="1" NAME="@@@ADMINUSERNAME@@@" FIRST_NAME="HQ"
              LAST_NAME="Administrator" EMAIL_ADDRESS="@@@ADMINEMAIL@@@"
              DSN="CAM" FSYSTEM="TRUE" FACTIVE="TRUE" HTML_EMAIL="FALSE"/>
    </table>

 

    <!-- TODO update the subject table to have a reference back to its resource
    <table name="EAM_SUBJECT">
        <data id="1" RESOURCE_ID="%EAM_RESOURCE.ID:6"/>
    </table> -->

    <!-- Define a role which includes our Admin User and
        has all the operations availble on the authz resource group -->
    <table name="EAM_ROLE">
        <data ID="0" NAME="Super User Role" FSYSTEM="TRUE"/>
    </table>

   
	<!-- TODO 
    <table name="EAM_ROLE">
        <data ID="0" RESOURCE_ID="%EAM_RESOURCE.ID:8"/>
    </table>-->

   


    <!-- add the root user to the root role -->
    <table name="EAM_SUBJECT_ROLE_MAP">
        <data ROLE_ID="%EAM_ROLE.ID:0" SUBJECT_ID="%EAM_SUBJECT.ID:1"/>
    </table>

 

    <!-- RESOURCE CREATOR ROLE DEFINITION STUFF. The entries here
         create a role which has the authzResourceGroup (all the 
         meta-entities for authz) and the basic createResource operation
         . All users will implicitly be associated with this role so
         as to guarantee their ability to create resources. -->
    <!-- create the resource creator role -->
    <table name="EAM_ROLE">
        <data ID="1" NAME="RESOURCE_CREATOR_ROLE" FSYSTEM="TRUE"/>
    </table>

  

    <!-- sigh... set the foreign key resource id on the role entry -->
    <!-- TODO
    <table name="EAM_ROLE">
        <data ID="1" RESOURCE_ID="%EAM_RESOURCE.ID:9"/>
    </table> -->

    <!-- add the authz resource group to the role -->
     <!-- TODO
    <table name="EAM_ROLE_RESOURCE_GROUP_MAP">
        <data ROLE_ID="%EAM_ROLE.ID:1" RESOURCE_GROUP_ID="%EAM_RESOURCE_GROUP.ID:0"/>
    </table> -->

    <!-- add the root user to the creator role -->
    <table name="EAM_SUBJECT_ROLE_MAP">
        <data ROLE_ID="%EAM_ROLE.ID:1" SUBJECT_ID="%EAM_SUBJECT.ID:1"/>
    </table>

   

    <!-- reserve two crispo IDs for the super and guest user dashboards -->
    <table name="EAM_CRISPO">
        <data ID="0"/>
        <data ID="2"/>
        <data ID="3"/>
    </table>

    <!-- create a guest subject -->
    <table name="EAM_SUBJECT">
        <data ID="2" NAME="guest" FIRST_NAME="Guest"
              LAST_NAME="User" EMAIL_ADDRESS="@@@ADMINEMAIL@@@"
              DSN="CAM" FSYSTEM="FALSE" FACTIVE="FALSE" HTML_EMAIL="FALSE"
              PREF_CRISPO_ID="3"/>
    </table>

  
 <!-- TODO
    <table name="EAM_SUBJECT">
        <data ID="2" RESOURCE_ID="%EAM_RESOURCE.ID:10"/>
    </table>-->

    <!-- set the default dashboard for view only role -->
    <table name="EAM_CRISPO_OPT">
        <data ID="2" PROPKEY=".user.dashboard.default.id" VAL="2" CRISPO_ID="3"/>
    </table>

    <!-- Define a view only role which includes the guest user and
        has all the read operations availble on the authz resource group -->
    <table name="EAM_ROLE">
        <data ID="2" NAME="Guest Role" FSYSTEM="FALSE"/>
    </table>

   
	<!-- TODO 
    <table name="EAM_ROLE">
        <data ID="2" RESOURCE_ID="%EAM_RESOURCE.ID:11"/>
    </table>-->

    <table name="EAM_DASH_CONFIG">
        <data ID="0" CONFIG_TYPE="ROLE" NAME="Super User Role" CRISPO_ID="0"
              ROLE_ID="%EAM_ROLE.ID:0"/>
        <data ID="2" CONFIG_TYPE="ROLE" NAME="Guest Role" CRISPO_ID="2"
              ROLE_ID="%EAM_ROLE.ID:2"/>
    </table>

  

    <!-- add the guest user to the view only role -->
    <table name="EAM_SUBJECT_ROLE_MAP">
        <data ROLE_ID="%EAM_ROLE.ID:2" SUBJECT_ID="%EAM_SUBJECT.ID:2"/>
    </table>

   

</Covalent.DBSetup>
