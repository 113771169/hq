<?xml version="1.0"?>
<!--
  NOTE: This copyright does *not* cover user programs that use HQ
  program services by normal system calls through the application
  program interfaces provided as part of the Hyperic Plug-in Development
  Kit or the Hyperic Client Development Kit - this is merely considered
  normal use of the program, and does *not* fall under the heading of
  "derived work".
  
  Copyright (C) [2004-2008], Hyperic, Inc.
  This file is part of HQ.
  
  HQ is free software; you can redistribute it and/or modify
  it under the terms version 2 of the GNU General Public License as
  published by the Free Software Foundation. This program is distributed
  in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
  even the implied warranty of MERCHANTABILITY or FITNESS FOR A
  PARTICULAR PURPOSE. See the GNU General Public License for more
  details.
  
  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
  USA.
 -->

<plugin name="exchange" version="@project.version@">

  <filter name="store" value="win32:Object=MSExchangeIS"/>
  <filter name="mta" value="win32:Object=MSExchangeMTA"/>
  <filter name="mbox" value="win32:Object=MSExchangeIS Mailbox,Instance=_Total"/>
  <filter name="imap4" value="win32:Object=MSExchangeIMAP4,Instance=_Total"/>
  <filter name="pop3" value="win32:Object=MSExchangePOP3,Instance=_Total"/>
  <filter name="web" value="win32:Object=MSExchange Web Mail,Instance=_Total"/>
  <filter name="queue" value="win32:Object=MSExchangeTransport Queues,Instance=_Total"/>
  <filter name="smtpsend" value="win32:Object=MSExchangeTransport SmtpSend,Instance=%name%"/>
  <filter name="smtprecv" value="win32:Object=MSExchangeTransport SmtpReceive,Instance=%name%"/>

  <!-- metrics for Exchange Information Store -->
  <filter name="template" value="${store}:${name}"/>
  <metrics name="exchange-is">
    <metric name="Availability"
            template="win32:Service=MSExchangeIS:${alias}"
            indicator="true"/>

    <metric name="RPC Packets"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="RPC Operations"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Read Bytes RPC Clients"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Write Bytes RPC Clients"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="RPC Averaged Latency"
            category="THROUGHPUT"
            units="ms"/>

    <metric name="RPC Num. Of Slow Packets"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Push Notifications Generated"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Push Notifications Skipped"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="RPC Requests"
            category="THROUGHPUT"
            indicator="true"/>

    <metric name="User Count"/>

    <metric name="Active User Count"/>

    <metric name="Maximum Users"
            collectionType="static"/>

    <metric name="Anonymous User Count"/>

    <metric name="Active Anonymous User Count"/>

    <metric name="Maximum Anonymous Users"
            collectionType="static"/>

    <metric name="Connection Count"
            category="UTILIZATION"
            indicator="true"/>

    <metric name="Active Connection Count"
            category="UTILIZATION"/>

    <metric name="Maximum Connections"
            category="UTILIZATION"
            collectionType="static"/>

    <metric name="Push Notifications Cache Size"/>

    <metric name="Single Appointments Created"
            collectionType="trendsup"/>

    <metric name="Recurring Appointments Created"
            collectionType="trendsup"/>

    <metric name="Single Appointments Modified"
            collectionType="trendsup"/>

    <metric name="Recurring Appointments Modified"
            collectionType="trendsup"/>

    <metric name="Single Appointments Deleted"
            collectionType="trendsup"/>

    <metric name="Recurring Appointments Deleted"
            collectionType="trendsup"/>

    <metric name="Recurring Master Appointments Expanded"
            collectionType="trendsup"/>

    <metric name="Appointment Instances Created"
            collectionType="trendsup"/>

    <metric name="Appointment Instances Deleted"
            collectionType="trendsup"/>

    <metric name="FB Publish Count"
            collectionType="trendsup"/>

    <metric name="Background Expansion Queue Length"
            category="THROUGHPUT"
            collectionType="dynamic"/>

    <metric name="Virus Scan Messages Processed"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Messages Cleaned"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Messages Quarantined"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Messages Deleted"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Files Scanned"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Files Cleaned"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Files Quarantined"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Bytes Scanned"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Virus Scan Queue Length"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Folders Scanned In Background"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Virus Scan Messages Scanned In Background"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="VM Largest Block Size"/>

    <metric name="VM Total Free Blocks"/>

    <metric name="VM Total 16MB Free Blocks"/>

    <metric name="VM Total Large Free Block Bytes"/>

    <metric name="DL Membership Cache Entries Count"/>

    <metric name="DL Membership Cache Size"/>

    <metric name="DL Membership Cache Hits"
            collectionType="trendsup"/>

    <metric name="DL Membership Cache Misses"
            collectionType="trendsup"/>

    <metric name="RPC Clients Bytes Read"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="RPC Clients Bytes Written"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="RPC Clients Uncompressed Bytes Read"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="RPC Clients Uncompressed Bytes Written"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Slow QP Threads"/>

    <metric name="Slow Search Threads"/>
  </metrics>

  <filter name="template" value="${web}:${name} (total)"/>
  <metrics name="Web">
    <metric name="Availability"
            template="HTTP:hostname=localhost,port=80,path=/exchange:${alias}"
            category="AVAILABILITY"
            indicator="true"/>

    <metric name="Attachments Deleted"
            collectionType="trendsup"/>

    <metric name="Message/Appointment Deletes"
            template="${web}:${name}* (total)"
            collectionType="trendsup"/>

    <metric name="Message Moves/Copies"
            template="${web}:${name}* (total)"
            collectionType="trendsup"/>

    <metric name="Message/Appointment Saves"
            collectionType="trendsup"/>

    <metric name="Posts Submitted"
            collectionType="trendsup"/>

    <metric name="Names Checked"
            collectionType="trendsup"/>

    <metric name="Recipients Edited"
            collectionType="trendsup"/>

    <metric name="Message Saves"
            collectionType="trendsup"/>

    <metric name="Recipients Saved"
            collectionType="trendsup"/>

    <metric name="Message Sends"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Appointment Edit Recurrence"
            collectionType="trendsup"/>

    <metric name="Appointment Updates"
            collectionType="trendsup"/>

    <metric name="Appointment Resolve Free-Busy"
            collectionType="trendsup"/>

    <metric name="Appointment Saves"
            collectionType="trendsup"/>

    <metric name="Appointment Sends"
            collectionType="trendsup"/>

    <metric name="Appointment Save Recurrences"
            collectionType="trendsup"/>

    <metric name="Message Attachment Edits"
            collectionType="trendsup"/>

    <metric name="Appointment Attachment Edits"
            collectionType="trendsup"/>

    <metric name="Navigation Options Saves"
            collectionType="trendsup"/>

    <metric name="Folder Creates"
            template="${web}:${name}* (total)"
            collectionType="trendsup"/>

    <metric name="Folder Renames"
            template="${web}:${name}* (total)"
            collectionType="trendsup"/>

    <metric name="Authentications"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Authentication Cache Hits"
            collectionType="trendsup"/>

    <metric name="Forms Sent"
            collectionType="trendsup"/>

    <metric name="Get App Frame"
            collectionType="trendsup"/>

    <metric name="Get Nav Bar"
            collectionType="trendsup"/>

    <metric name="Folder Get Contents"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Folder Get View"
            template="${web}:${name}* (total)"
            collectionType="trendsup"/>

    <metric name="New Item URL"
            collectionType="trendsup"/>

    <metric name="New Folder Template Data"
            collectionType="trendsup"/>

    <metric name="Appointment Data Retrieves"
            collectionType="trendsup"/>

    <metric name="Appointment Accept/Decline"
            collectionType="trendsup"/>

    <metric name="Message/Appointment Opens"
            collectionType="trendsup"/>

    <metric name="Message Opens"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Appointment Opens"
            collectionType="trendsup"/>

    <metric name="Views Of Calendars"
            collectionType="trendsup"/>

    <metric name="Views Of Mail Folders"
            collectionType="trendsup"/>

    <metric name="Authentications in Cache"
            template="${web}:Authentications (in cache)"
            collectionType="trendsup"/>
  </metrics>

  <filter name="template" value="${mta}:${name}"/>
  <metrics name="MTA">
    <metric name="Availability"
            template="win32:Service=MSExchangeMTA:${alias}"
            indicator="true"/>

    <metric name="Adjacent MTA Associations"/>

    <metric name="Messages Processed"
            template="${mta}:Messages/Sec"
            category="THROUGHPUT"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Message Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Free Buffer Elements"
            template="${mta}:Free Elements"/>

    <metric name="Free Buffer Headers"
            template="${mta}:Free Headers"/>

    <metric name="Admin Connections"/>

    <metric name="Threads In Use"/>

    <metric name="Work Queue Length"
            category="PERFORMANCE"
            indicator="true"/>

    <metric name="XAPI Gateways"/>

    <metric name="XAPI Clients"/>

    <metric name="Disk File Deletes"
            template="${template}/sec"
            collectionType="trendsup"/>

    <metric name="Disk File Syncs"
            template="${template}/sec"
            collectionType="trendsup"/>

    <metric name="Disk File Opens"
            template="${template}/sec"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Disk File Reads"
            template="${template}/sec"
            collectionType="trendsup"/>

    <metric name="Disk File Writes"
            template="${template}/sec"
            collectionType="trendsup"/>

    <metric name="Directory Service Read Calls"
            template="${mta}:ExDS Read Calls/sec"
            collectionType="trendsup"/>

    <metric name="XAPI Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="XAPI Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Admin Interface Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Admin Interface Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="LAN Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="LAN Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="RAS Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="RAS Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="TCP/IP Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="TCP/IP Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="TP4 Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="TP4 Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="X.25 Receive Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="X.25 Transmit Bytes"
            template="${template}/sec"
            category="THROUGHPUT"
            collectionType="trendsup"
            units="B"/>

    <metric name="Deferred Delivery Messages"
            template="${mta}:Deferred Delivery Msgs"
            category="THROUGHPUT"/>

    <metric name="Total Recipients Queued"/>

    <metric name="Total Successful Conversions"
            collectionType="trendsup"/>

    <metric name="Total Failed Conversions"
            collectionType="trendsup"/>

    <metric name="Total Loops Detected"
            collectionType="trendsup"/>

    <metric name="Inbound Messages Total"
            collectionType="trendsup"/>

    <metric name="Outbound Messages Total"
            collectionType="trendsup"/>

    <metric name="Inbound Bytes Total"
            category="THROUGHPUT"
            indicator="true"
            collectionType="trendsup"
            units="B"/>

    <metric name="Work Queue Bytes"
            category="THROUGHPUT"
            units="B"/>

    <metric name="Outbound Bytes Total"
            category="THROUGHPUT"
            indicator="true"
            collectionType="trendsup"
            units="B"/>

    <metric name="Total Recipients Inbound"
            collectionType="trendsup"/>

    <metric name="Total Recipients Outbound"
            collectionType="trendsup"/>
  </metrics>

  <filter name="template" value="${mbox}:${name}"/>
  <metrics name="exchange-mbox">
    <metric name="Send Queue Size"/> <!-- gone in 2007? -->

    <metric name="Receive Queue Size"
            indicator="true"/>

    <metric name="Categorization Count"
            collectionType="trendsup"/>

    <metric name="Messages Delivered"
            category="THROUGHPUT"
            collectionType="trendsup"/>

    <metric name="Message Recipients Delivered"
            collectionType="trendsup"/>

    <metric name="Messages Sent"
            collectionType="trendsup"/>

    <metric name="Messages Submitted"
            collectionType="trendsup"/>

    <metric name="Single Instance Ratio"/>

    <metric name="Average Delivery Time"/>

    <metric name="Total Size of Recoverable Items"/>

    <metric name="Total Count of Recoverable Items"/>

    <metric name="Client Logons"
            collectionType="trendsup"/>

    <metric name="Active Client Logons"/>

    <metric name="Local deliveries"/>
  </metrics>

  <filter name="template" value="${imap4}:${name}"/>
  <metrics name="IMAP4">
    <metric name="APPEND Total"
            collectionType="trendsup"/>

    <metric name="APPEND Failures"
            collectionType="trendsup"/>

    <metric name="AUTHENTICATE Total"
            collectionType="trendsup"/>

    <metric name="AUTHENTICATE Failures"
            collectionType="trendsup"/>

    <metric name="CAPABILITY Total"
            collectionType="trendsup"/>

    <metric name="CAPABILITY Failures"
            collectionType="trendsup"/>

    <metric name="CHECK Total"
            collectionType="trendsup"/>

    <metric name="CHECK Failures"
            collectionType="trendsup"/>

    <metric name="CLOSE Total"
            collectionType="trendsup"/>

    <metric name="CLOSE Failures"
            collectionType="trendsup"/>

    <metric name="COPY Total"
            collectionType="trendsup"/>

    <metric name="COPY Failures"
            collectionType="trendsup"/>

    <metric name="CREATE Total"
            collectionType="trendsup"/>

    <metric name="CREATE Failures"
            collectionType="trendsup"/>

    <metric name="DELETE Total"
            collectionType="trendsup"/>

    <metric name="DELETE Failures"
            collectionType="trendsup"/>

    <metric name="EXAMINE Total"
            collectionType="trendsup"/>

    <metric name="EXAMINE Failures"
            collectionType="trendsup"/>

    <metric name="EXPUNGE Total"
            collectionType="trendsup"/>

    <metric name="EXPUNGE Failures"
            collectionType="trendsup"/>

    <metric name="FETCH Total"
            collectionType="trendsup"/>

    <metric name="FETCH Failures"
            collectionType="trendsup"/>

    <metric name="LIST Total"
            collectionType="trendsup"/>

    <metric name="LIST Failures"
            collectionType="trendsup"/>

    <metric name="LOGIN Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="LOGIN Failures"
            collectionType="trendsup"/>

    <metric name="LOGOUT Total"
            collectionType="trendsup"/>

    <metric name="LOGOUT Failures"
            collectionType="trendsup"/>

    <metric name="LSUB Total"
            collectionType="trendsup"/>

    <metric name="LSUB Failures"
            collectionType="trendsup"/>

    <metric name="NOOP Total"
            collectionType="trendsup"/>

    <metric name="NOOP Failures"
            collectionType="trendsup"/>

    <metric name="RENAME Total"
            collectionType="trendsup"/>

    <metric name="RENAME Failures"
            collectionType="trendsup"/>

    <metric name="RLIST Total"
            collectionType="trendsup"/>

    <metric name="RLIST Failures"
            collectionType="trendsup"/>

    <metric name="RLSUB Total"
            collectionType="trendsup"/>

    <metric name="RLSUB Failures"
            collectionType="trendsup"/>

    <metric name="SEARCH Total"
            collectionType="trendsup"/>

    <metric name="SEARCH Failures"
            collectionType="trendsup"/>

    <metric name="SELECT Total"
            collectionType="trendsup"/>

    <metric name="SELECT Failures"
            collectionType="trendsup"/>

    <metric name="STATUS Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="STATUS Failures"
            collectionType="trendsup"/>

    <metric name="STORE Total"
            collectionType="trendsup"/>

    <metric name="STORE Failures"
            collectionType="trendsup"/>

    <metric name="SUBSCRIBE Total"
            collectionType="trendsup"/>

    <metric name="SUBSCRIBE Failures"
            collectionType="trendsup"/>

    <metric name="UID Total"
            collectionType="trendsup"/>

    <metric name="UID Failures"
            collectionType="trendsup"/>

    <metric name="UNSUBSCRIBE Total"
            collectionType="trendsup"/>

    <metric name="UNSUBSCRIBE Failures"
            collectionType="trendsup"/>

    <metric name="IDLE Total"
            collectionType="trendsup"/>

    <metric name="IDLE Failures"
            collectionType="trendsup"/>

    <metric name="NAMESPACE Total"
            collectionType="trendsup"/>

    <metric name="NAMESPACE Failures"
            collectionType="trendsup"/>

    <metric name="Invalid Commands"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Connections Failed"
            collectionType="trendsup"/>

    <metric name="Connections Rejected"
            collectionType="trendsup"/>
  </metrics>

  <metrics name="IMAP4_V5" include="IMAP4">
    <metric name="Availability"
            template="win32:Service=IMAP4Svc:${alias}"
            category="AVAILABILITY"
            indicator="true"/>

    <metric name="Connections Total"
            collectionType="trendsup"/>

    <metric name="Connections Current"
            indicator="true"/>
  </metrics>

  <metrics name="IMAP4_V8" include="IMAP4">
    <!-- 2007 service name changearoo -->
    <metric name="Availability"
            template="win32:Service=MSExchangeImap4:${alias}"
            category="AVAILABILITY"
            indicator="true"/>

    <!-- 2007 name swaparoo -->
    <metric name="Connections Total"
            template="${imap4}:Total Connections"
            collectionType="trendsup"/>

    <metric name="Connections Current"
            template="${imap4}:Current Connections"
            indicator="true"/>
  </metrics>

  <filter name="template" value="${pop3}:${name}"/>
  <metrics name="POP3">
    <metric name="AUTH Total"
            collectionType="trendsup"/>

    <metric name="AUTH Failures"
            collectionType="trendsup"/>

    <metric name="PASS Total"
            collectionType="trendsup"/>

    <metric name="PASS Failures"
            collectionType="trendsup"/>

    <metric name="QUIT Total"
            collectionType="trendsup"/>

    <metric name="QUIT Failures"
            collectionType="trendsup"/>

    <metric name="STAT Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="STAT Failures"
            collectionType="trendsup"/>

    <metric name="LIST Total"
            collectionType="trendsup"/>

    <metric name="LIST Failures"
            collectionType="trendsup"/>

    <metric name="RETR Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="RETR Failures"
            collectionType="trendsup"/>

    <metric name="DELE Total"
            collectionType="trendsup"/>

    <metric name="DELE Failures"
            collectionType="trendsup"/>

    <metric name="NOOP Total"
            collectionType="trendsup"/>

    <metric name="NOOP Failures"
            collectionType="trendsup"/>

    <metric name="RSET Total"
            collectionType="trendsup"/>

    <metric name="RSET Failures"
            collectionType="trendsup"/>

    <metric name="TOP Total"
            collectionType="trendsup"/>

    <metric name="TOP Failures"
            collectionType="trendsup"/>

    <metric name="UIDL Total"
            collectionType="trendsup"/>

    <metric name="UIDL Failures"
            collectionType="trendsup"/>

    <metric name="USER Total"
            collectionType="trendsup"/>

    <metric name="USER Failures"
            collectionType="trendsup"/>

    <metric name="Invalid Commands"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Connections Total"
            collectionType="trendsup"/>

    <metric name="Connections Current"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Connections Failed"
            collectionType="trendsup"/>

    <metric name="Connections Rejected"
            collectionType="trendsup"/>

    <metric name="CAPA Total"
            collectionType="trendsup"/>

    <metric name="CAPA Failures"
            collectionType="trendsup"/>
  </metrics>

  <metrics name="POP3_V5" include="POP3">
    <metric name="Availability"
            template="win32:Service=POP3Svc:${alias}"
            category="AVAILABILITY"
            indicator="true"/>

    <!-- gone in 2007 -->
    <metric name="LAST Total"
            collectionType="trendsup"/>

    <metric name="LAST Failures"
            collectionType="trendsup"/>
  </metrics>

  <metrics name="POP3_V8" include="POP3">
    <!-- 2007 service name changearoo -->
    <metric name="Availability"
            template="win32:Service=MSExchangePop3:${alias}"
            category="AVAILABILITY"
            indicator="true"/>
  </metrics>

  <!-- metrics for MSExchangeTransport Queues -->
  <filter name="template" value="${queue}:${name}"/>
  <metrics name="exchange-transport">
    <metric name="Availability"
            template="win32:Service=MSExchangeTransport:${alias}"
            indicator="true"/>

    <metric name="Active Remote Delivery Queue Length"/>

    <metric name="Retry Remote Delivery Queue Length"/>

    <metric name="Active Mailbox Delivery Queue Length"/>

    <metric name="Retry Mailbox Delivery Queue Length"/>

    <metric name="Active Non-Smtp Delivery Queue Length"/>

    <metric name="Retry Non-Smtp Delivery Queue Length"/>

    <metric name="Aggregate Delivery Queue Length (All Queues)"
            indicator="true"/>

    <metric name="Items Queued For Delivery Total"
            collectionType="trendsup"/>

    <metric name="Items Completed Delivery Total"
            collectionType="trendsup"/>

    <metric name="Items Queued For Delivery Expired Total"
            collectionType="trendsup"/>

    <metric name="Items Deleted By Admin Total"
            collectionType="trendsup"/>

    <metric name="Items Resubmitted Total"
            collectionType="trendsup"/>

    <metric name="Messages Queued For Delivery Total"
            collectionType="trendsup"/>

    <metric name="Messages Completed Delivery Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Unreachable Queue Length"/>

    <metric name="Poison Queue Length"/>

    <metric name="Submission Queue Length"/>

    <metric name="Messages Submitted Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Submission Queue Items Expired Total"
            collectionType="trendsup"/>
  </metrics>

  <filter name="template" value="${smtpsend}:${name}"/>
  <metrics name="exchange-smtpsend">
    <metric name="Availability"
            template="win32:Service=MSExchangeTransport:${alias}"
            indicator="true"/>

    <metric name="Connections Current"/>

    <metric name="Connections Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Messages Sent Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Message Bytes Sent Total"
            indicator="true"
            units="B"
            collectionType="trendsup"/>

    <metric name="Bytes Sent Total"
            collectionType="trendsup"/>

    <metric name="Recipients Sent"
            collectionType="trendsup"/>

    <metric name="Average Recipients/message"/>

    <metric name="Average Message bytes/message"
            units="B"/>

    <metric name="Average Messages/connection"/>

    <metric name="Average Bytes/connection"
            units="B"/>
  </metrics>

  <filter name="template" value="${smtprecv}:${name}"/>
  <metrics name="exchange-smtprecv">
    <metric name="Availability"
            template="win32:Service=MSExchangeTransport:${alias}"
            indicator="true"/>

    <metric name="Connections Current"/>

    <metric name="Connections Total"
            indicator="true"/>

    <metric name="Disconnections By Agents"/>

    <metric name="Messages Received Total"
            indicator="true"
            collectionType="trendsup"/>

    <metric name="Message Bytes Received Total"
            collectionType="trendsup"/>

    <metric name="Messages Refused for Size"/>

    <metric name="Recipients Accepted Total"
            collectionType="trendsup"/>

    <metric name="Average Bytes/message"
            units="B"/>

    <metric name="Average Recipients/message"/>

    <metric name="Average Bytes/connection"
            units="B"/>

    <metric name="Average Messages/connection"/>

    <metric name="Bytes Received Total"
            collectionType="trendsup"/>

    <metric name="Tarpitting Delays Authenticated"/>

    <metric name="Tarpitting Delays Anonymous"/>
  </metrics>

  <metrics name="Exchange 5.5" include="exchange-is,exchange-mbox"/>
  <metrics name="Exchange 2000" include="exchange-is,exchange-mbox"/>
  <metrics name="Exchange 2003" include="exchange-is,exchange-mbox"/>
  <metrics name="Exchange 2007" include="exchange-is,exchange-mbox"/>
  <metrics name="Exchange Transport 2007" include="exchange-transport"/>

  <metrics name="Exchange 5.5 POP3" include="POP3_V5"/>
  <metrics name="Exchange 2000 POP3" include="POP3_V5"/>
  <metrics name="Exchange 2003 POP3" include="POP3_V5"/>
  <metrics name="Exchange 2007 POP3" include="POP3_V8"/>

  <metrics name="Exchange 5.5 IMAP4" include="IMAP4_V5"/>
  <metrics name="Exchange 2000 IMAP4" include="IMAP4_V5"/>
  <metrics name="Exchange 2003 IMAP4" include="IMAP4_V5"/>
  <metrics name="Exchange 2007 IMAP4" include="IMAP4_V8"/>

  <metrics name="Exchange 5.5 MTA" include="MTA"/>
  <metrics name="Exchange 2000 MTA" include="MTA"/>
  <metrics name="Exchange 2003 MTA" include="MTA"/>

  <metrics name="Exchange 5.5 Web" include="Web"/>
  <metrics name="Exchange 2000 Web" include="Web"/>
  <metrics name="Exchange 2003 Web" include="Web"/>
  <metrics name="Exchange 2007 Web" include="Web"/>

  <metrics name="Exchange Transport 2007 SmtpSend"
           include="exchange-smtpsend"/>

  <metrics name="Exchange Transport 2007 SmtpReceive"
           include="exchange-smtprecv"/>

  <server name="Exchange"
          description="Mail Server"
          version="5.5"
          platforms="Win32">

    <plugin type="measurement"
            class="org.hyperic.hq.product.Win32MeasurementPlugin"/>

    <plugin type="autoinventory"
            class="ExchangeDetector"/>

    <property name="EVENT_LOG_SOURCE_FILTER"
              value="MSExchange"/>

    <plugin type="log_track"
            class="org.hyperic.hq.product.Win32EventLogTrackPlugin"/>    

    <property name="VERSION_FILE" value="enotimpl.dll"/>

    <properties>
       <property name="version"
                 description="Exchange Version"/>
       <property name="build"
                 description="Build Number"/>
    </properties>

    <service name="POP3" internal="true">
      <plugin type="measurement"/>
      <plugin type="log_track"/>
      <property name="EVENT_LOG_SOURCE_FILTER" value="POP3SVC"/>
    </service>

    <service name="IMAP4" internal="true">
      <plugin type="measurement"/>
      <plugin type="log_track"/>
      <property name="EVENT_LOG_SOURCE_FILTER" value="IMAP4SVC"/>
    </service>

    <service name="MTA" internal="true">
      <plugin type="measurement"/>
      <plugin type="log_track"/>
      <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangeMTA"/>
    </service>

    <service name="Web">
      <plugin type="measurement"/>
    </service>
  </server>

  <server name="Exchange"
          version="2000"
          include="5.5">

    <property name="VERSION_FILE" value="peexch60.dll"/>
  </server>

  <server name="Exchange"
          version="2003"
          include="2000">

    <property name="VERSION_FILE" value="masperf.dll"/>
  </server>

  <!-- not using include="2003":
       No MTA service
       New Transport service
       Service name changes for EVENT_LOG_SOURCE_FILTER
  -->
  <server name="Exchange" version="2007" platforms="Win32">

    <plugin type="measurement"
            class="org.hyperic.hq.product.Win32MeasurementPlugin"/>

    <plugin type="autoinventory"
            class="ExchangeDetector"/>

    <property name="EVENT_LOG_SOURCE_FILTER"
              value="MSExchange"/>

    <plugin type="log_track"
            class="org.hyperic.hq.product.Win32EventLogTrackPlugin"/>    

    <property name="VERSION_FILE" value="offfilt.dll"/>

    <properties>
       <property name="version"
                 description="Exchange Version"/>
       <property name="build"
                 description="Build Number"/>
    </properties>

    <service name="POP3" internal="true">
      <plugin type="measurement"/>
      <plugin type="log_track"/>
      <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangePOP3"/>
    </service>

    <service name="IMAP4" internal="true">
      <plugin type="measurement"/>
      <plugin type="log_track"/>
      <property name="EVENT_LOG_SOURCE_FILTER" value="MSExchangeIMAP4"/>
    </service>

    <service name="Web">
      <plugin type="measurement"/>
    </service>
  </server>

  <server name="Exchange Transport" version="2007" platforms="Win32">

    <plugin type="measurement"
            class="org.hyperic.hq.product.Win32MeasurementPlugin"/>

    <plugin type="autoinventory"
            class="ExchangeTransportDetector"/>

    <property name="EVENT_LOG_SOURCE_FILTER"
              value="MSExchangeTransport"/>

    <plugin type="log_track"
            class="org.hyperic.hq.product.Win32EventLogTrackPlugin"/>    

    <service name="SmtpSend">
      <config>
        <option name="name" description="Name"/>
      </config>
      <plugin type="measurement"/>
    </service>

    <service name="SmtpReceive">
      <config>
        <option name="name" description="Name"/>
      </config>
      <plugin type="measurement"/>
    </service>
  </server>
</plugin>
