<?xml version="1.0"?>
<!-- MQSeries metrics -->
<!--
NOTE: This copyright does *not* cover user programs that use HQ
program services by normal system calls through the application
program interfaces provided as part of the Hyperic Plug-in Development
Kit or the Hyperic Client Development Kit - this is merely considered
normal use of the program, and does *not* fall under the heading of
"derived work".

Copyright (C) [2004, 2005, 2006], Hyperic, Inc.
This file is part of HQ.

HQ is free software; you can redistribute it and/or modify
it under the terms version 2 of the GNU General Public License as
published by the Free Software Foundation. This program is distributed
in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE. See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
USA.
-->

<plugin package="org.hyperic.hq.plugin.wsmq" class="MQSeriesProductPlugin">
    
    <metrics name="WebSphere MQ QManager Listener">
        <metric name="Availability" template="sigar:Type=ProcState,Arg=%process.query%:State" indicator="true"/>
        <metric name="Process Virtual Memory Size" template="sigar:Type=ProcMem,Arg=%process.query%:Size" units="B"/>
        <metric name="Process Resident Memory Size" template="sigar:Type=ProcMem,Arg=%process.query%:Resident" indicator="true" units="B"/>
        <metric name="Process Page Faults" template="sigar:Type=ProcMem,Arg=%process.query%:PageFaults" collectionType="trendsup"/>
        <metric name="Process Cpu System Time" template="sigar:Type=ProcCpu,Arg=%process.query%:Sys" units="ms" collectionType="trendsup"/>
        <metric name="Process Cpu User Time" template="sigar:Type=ProcCpu,Arg=%process.query%:User" units="ms" collectionType="trendsup"/>
        <metric name="Process Cpu Total Time" template="sigar:Type=ProcCpu,Arg=%process.query%:Total" units="ms" collectionType="trendsup"/>
        <metric name="Process Cpu Usage" template="sigar:Type=ProcCpu,Arg=%process.query%:Percent" indicator="true" units="percentage"/>
        <metric name="Process Start Time" template="sigar:Type=ProcTime,Arg=%process.query%:StartTime" category="AVAILABILITY" units="epoch-millis" collectionType="static"/>
        <metric name="Process Open File Descriptors" template="sigar:Type=ProcFd,Arg=%process.query%:Total"/>
        <metric name="Process Threads" template="sigar:Type=ProcState,Arg=%process.query%:Threads"/>
    </metrics>
    
    <metrics name="WebSphere MQ QManager 1.0">
        <metric name="Availability" alias="Availability" template="mqseries-mgr:Mgr=%queue.manager.name%:Availability" category="AVAILABILITY" indicator="true" collectionType="dynamic" units="percentage" interval="60000"/>
    </metrics>
    
    <metrics name="WebSphere MQ QManager 1.0 Channel">
        <metric name="Availability" alias="Availability" template="mqseries-channel:Mgr=%queue.manager.name%,Channel=%channel.name%:Availability" category="AVAILABILITY" indicator="true" collectionType="dynamic" units="percentage" interval="60000"/>
    </metrics>
    
    <metrics name="WebSphere MQ QManager 1.0 Sender Channel">
        <include name="WebSphere MQ QManager 1.0 Channel"/>
        <metric name="Msgs" alias="Msgs" template="mqseries-channel:Mgr=%queue.manager.name%,Channel=%channel.name%:Msgs" category="THROUGHPUT" indicator="true" collectionType="trendsup" units="none"/>
    </metrics>
    
    <metrics name="WebSphere MQ QManager 1.0 Receiver Channel">
        <include name="WebSphere MQ QManager 1.0 Channel"/>
    </metrics>
    
    <metrics name="WebSphere MQ QManager 1.0 Queue">
        <metric name="Availability" alias="Availability" template="mqseries-queue:Mgr=%queue.manager.name%,Queue=%queue.name%:Availability" category="AVAILABILITY" indicator="true" collectionType="dynamic" units="percentage" interval="60000"/>
        <metric name="Current Depth" alias="CurrentDepth" template="mqseries-queue:Mgr=%queue.manager.name%,Queue=%queue.name%:CurrentDepth" category="UTILIZATION" indicator="true" collectionType="dynamic" units="none" interval="60000"/>
        <metric name="Open Input Count" alias="OpenInputCount" template="mqseries-queue:Mgr=%queue.manager.name%,Queue=%queue.name%:OpenInputCount" category="UTILIZATION" collectionType="dynamic" units="none" interval="60000"/>
        <metric name="Open Output Count" alias="OpenOutputCount" template="mqseries-queue:Mgr=%queue.manager.name%,Queue=%queue.name%:OpenOutputCount" category="UTILIZATION" collectionType="dynamic" units="none" interval="60000"/>
    </metrics>
    
    <metrics name="WebSphere MQ QManager 1.0 SystemQueue">
        <include name="WebSphere MQ QManager 1.0 Queue"/>
    </metrics>
    
    <property name="mqseries.regkey"
     value="SOFTWARE\IBM\MQSeries\CurrentVersion"/>
    
    <server name="WebSphere MQ QManager" version="1.0" description="WebSphere MQ QManager">
        <plugin type="measurement" class="MQSeriesMeasurementPlugin"/>
        <plugin type="autoinventory" class="MQSeriesDetector"/>
        <scan registry="${mqseries.regkey}">
            <include name="FilePath"/>
        </scan>
        
        <scan>
            <include name="/**/bin/runmqlsr"/>
        </scan>
        
        <config>
            <option name="queue.manager.name" description="Queue manager name"/>
        </config>
        
        <service name="SystemQueue">
            <config>
                <option name="queue.name" description="Queue name"/>
            </config>
        </service>
        <service name="Queue">
            <config>
                <option name="queue.name" description="Queue name"/>
            </config>
        </service>
        <service name="Receiver Channel">
            <config>
                <option name="channel.name" description="Queue name"/>
            </config>
        </service>
        <service name="Sender Channel">
            <config>
                <option name="channel.name" description="Queue name"/>
            </config>
        </service>
        <service name="Channel">
            <config>
                <option name="channel.name" description="Queue name"/>
            </config>
        </service>
        <service name="Listener">
            <config>
                <option name="process.query" description="PTQL for listener process"/>
            </config>
        </service>
    </server>
</plugin>
